/*
 * viddy
 * v1.4.1
 * https://github.com/shuckster/viddy
 * License: MIT
 */
var libViddy=(()=>{var Y=Object.defineProperty,it=Object.defineProperties,at=Object.getOwnPropertyDescriptor,ct=Object.getOwnPropertyDescriptors,ut=Object.getOwnPropertyNames,K=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Oe=(e,t,n)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O=(e,t)=>{for(var n in t||(t={}))re.call(t,n)&&Oe(e,n,t[n]);if(K)for(var n of K(t))ve.call(t,n)&&Oe(e,n,t[n]);return e},M=(e,t)=>it(e,ct(t));var I=(e,t)=>{var n={};for(var r in e)re.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&K)for(var r of K(e))t.indexOf(r)<0&&ve.call(e,r)&&(n[r]=e[r]);return n};var lt=(e,t)=>{for(var n in t)Y(e,n,{get:t[n],enumerable:!0})},mt=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ut(t))!re.call(e,o)&&o!==n&&Y(e,o,{get:()=>t[o],enumerable:!(r=at(t,o))||r.enumerable});return e};var ft=e=>mt(Y({},"__esModule",{value:!0}),e);var $t={};lt($t,{ViddyError:()=>W,qsArray:()=>P,serialize:()=>At,unserialize:()=>Dt,viddy:()=>et,viddyWell:()=>Bt});var pt=Object.defineProperty;var dt=(e,t)=>{for(var n in t)pt(e,n,{get:t[n],enumerable:!0})},se={};dt(se,{instanceOf:()=>ie,isArguments:()=>xe,isArray:()=>yt,isDate:()=>gt,isFunction:()=>Ot,isNumber:()=>bt,isObject:()=>we,isPojo:()=>wt,isRegExp:()=>xt,isString:()=>vt});var be=Object.prototype,ht=be.toString,Z=e=>t=>typeof t===e,ie=e=>t=>t instanceof e,{isArray:yt}=Array,xe=e=>ht.call(e)==="[object Arguments]",gt=e=>ie(Date)(e)&&!isNaN(e),Ot=Z("function"),vt=Z("string"),bt=e=>e===e&&Z("number")(e),we=e=>e!==null&&Z("object")(e),xt=ie(RegExp),wt=e=>e===null||!we(e)||xe(e)?!1:Object.getPrototypeOf(e)===be,{isArray:p,isDate:qt,isFunction:k,isNumber:N}=se,{isPojo:h,isRegExp:C,isString:c,instanceOf:Vt}=se;function f(e){return(...t)=>ae(...t)(e)}var ae=(...e)=>{let t;return n=>e.find(r=>{let o=r(n),{matched:s,value:i}=o||{};return[s,i].every(k)?s(n)&&(t=i(n),!0):o&&(t=o)})&&t},d=e=>t=>({matched:()=>!0,value:()=>k(e)?e(t):e}),oe=e=>t=>n=>({matched:()=>F(e,n,r=>n=r),value:()=>k(t)?c(n)&&C(e)?t(...Et(n.match(e))):t(n):t}),a=(...e)=>{if(e.length===1){let[t]=e;return oe(t)}if(e.length===2){let[t,n]=e;return oe(t)(n)}if(e.length>2){let t=e.slice(-1)[0],n=e.slice(0,-1);return oe(b(n))(t)}throw new Error("expected 1 or 2 arguments")},Et=e=>{let{groups:t}=e;return t?[t,e]:[e]},F=(e,t,n)=>h(e)?Object.keys(e).every(r=>F(e[r],t==null?void 0:t[r],n)):p(e)?p(t)&&e.length===t.length&&e.every((r,o)=>F(r,t==null?void 0:t[o],n)):k(e)?e(t,n):c(t)&&C(e)?e.test(t):e===t||[e,t].every(Number.isNaN),V=(...e)=>(t,n)=>e.length===0||(k(e[0])?e[0](t):F(e[0],t,n))?(n(t),!0):!1,z=e=>(t,n)=>!F(e,t,n),L=(...e)=>(t,n)=>e.flat().some(r=>F(r,t,n)),b=(...e)=>(t,n)=>e.flat().every(r=>F(r,t,n));var ce=e=>e!==e||!e&&e!==0&&e!==!1||p(e)&&!e.length||h(e)&&!Object.keys(e).length,Ee=e=>!ce(e);var Me=e=>Mt(t=>t.includes(e));var Mt=e=>(t,n)=>(p(t)||c(t))&&e(t,n);var ue=e=>c(e)?(t,n)=>t[e]-n[e]:(t,n)=>t-n;function ee(e,t){let[n,r]=Tt(e,t);return[(...s)=>(r(),n(...s)),r]}function Tt(e,t){let n;return[(...s)=>{n=setTimeout(t,e,...s)},()=>clearTimeout(n)]}var Te=(...e)=>t=>e.reduceRight((n,r)=>r(n),t);function le(e,t=new Map){return n=>t.has(n)?t.get(n):t.set(n,e(n)).get(n)}var Se=(e,t)=>Object.entries(e).reduce((n,[r,o])=>(n[r]=t(o,r),n),{}),R=e=>e,A=()=>({valueOf:()=>{},toString:()=>"Nothing",map:()=>A(),chain:()=>A(),fork:e=>e(),orElse:e=>e(),ap:()=>A()});A.of=()=>A();var D=e=>({valueOf:()=>e,toString:()=>`Just(${e})`,map:t=>D(t(e)),chain:t=>t(e),fork:(t,n)=>n(e),orElse:()=>D(e),ap:t=>t.map(e)});D.of=e=>D(e);var St=(e=t=>t!=null)=>{let t=n=>e(n)?D(n):A();return t.of=n=>t(n),t},Ie=e=>{try{return D(e())}catch(t){return A()}},Gt=St(),Ce=e=>()=>D(e);var Ne=e=>e instanceof HTMLElement,je=e=>e.offsetParent!==null,P=e=>Ie(()=>document.querySelectorAll(e)).map(Array.from).orElse(Ce([])).valueOf();function Fe(e){let t=[],n=e.parentNode;for(;n&&n!==document;)t.push(n),n=n.parentNode;return t}function ke(e){let{top:t,left:n,width:r,height:o}=e.getBoundingClientRect(),s=r/2,i=o/2,u=n+s,y=t+i;return{el:e,x:u,y,halfWidth:s,halfHeight:i}}function Le(e,t){let n=t.x-e.x,r=t.y-e.y,o=Pe(n,r,e.x,e.y,e.halfWidth,e.halfHeight),s=Pe(-n,-r,t.x,t.y,t.halfWidth,t.halfHeight);return Math.hypot(o.x-s.x,o.y-s.y)}function Pe(e,t,n,r,o,s){return Math.abs(t/e)<s/o?{x:n+(e>0?o:-o),y:r+t*o/Math.abs(e)}:{x:n+e*s/Math.abs(t),y:r+(t>0?s:-s)}}function Ae(e){let t=e.toLowerCase();return n=>n.textContent.toLowerCase().includes(t)&&n.innerText.toLowerCase().includes(t)}var De=e=>t=>e.test(t.textContent)&&e.test(t.innerText);function G(e){if(!(e instanceof Element))return;let t=[];for(;e.nodeType===Node.ELEMENT_NODE;){let n=e.nodeName.toLowerCase();if(e.id){t.unshift(`${n}#${e.id}`);break}let r=e,o=1;for(;r=r.previousElementSibling;)r.nodeName.toLowerCase()===n&&o++;let s=n;o>1&&(s+=":nth-of-type("+o+")"),t.unshift(s),e=e.parentNode}return t.join(" > ")}function me(e){return f(e)(a({val:k})(t=>t.val()),a({tagName:"SELECT",multiple:!0})(({options:t})=>Array.from(t).reduce((n,r)=>r.selected?n.concat(r.value):n,[])),a({type:"checkbox",value:Ee})(t=>t.checked?t.value:""),a({type:"checkbox"})(t=>t.checked?"checked":""),a({contenteditable:!0})(t=>t.innerHTML),d(t=>t.value))}function fe(e,t){let n=t?new MutationObserver(o):new MutationObserver(r);return n.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),()=>n.disconnect();function r(s){setTimeout(()=>e(s),1)}function o(s){let i=P(t);for(let u of s){let y=u.target;if(i.some(T=>y.contains(T))){setTimeout(()=>e(),1);break}}}}var Re=(e,t)=>{let[n]=ee(32,t),r=P(e).map(o=>(o.addEventListener("change",n,{passive:!0}),()=>o.removeEventListener("change",n))).concat(()=>document.body.removeEventListener("click",n)).concat(()=>document.body.removeEventListener("keyup",n));return document.body.addEventListener("click",n,{passive:!0}),document.body.addEventListener("keyup",n,{passive:!0}),()=>r.forEach(o=>o())};var We="body *",Be=["button","submit","reset","file"],$e=Be.map(e=>`input:not([type=${e}])`).concat("select","textarea").join(", "),It=Be.map(e=>`input[type=${e}]`).concat("a","button").join(", "),He=5,Ct=500,Pt=b(p,ce),m=L(c,C),Nt=L(m,h),jt=L(b(h,{pattern:m}),b(h,{selector:c})),qe=b(h,{pattern:m,selector:z(c)}),Ve=b(h,{pattern:z(m),selector:z(c)}),ze=b(h,{selector:z(c),pickParent:z(c)}),de="|<-REGEXP::FLAGS->|",Ft=b(c,Me(de)),kt=e=>[e.source,e.flags].join(de),Lt=e=>new RegExp(...e.split(de)),At=(...e)=>JSON.stringify(e,(t,n)=>f(n)(a(C)(kt),d(n))),Dt=e=>JSON.parse(e,(t,n)=>f(n)(a(Ft)(Lt),d(n))),W=class extends Error{constructor(t,n,{message:r="could not resolve query to any elements"}){let o=u=>`/${u.source}/${u.flags}`,s=(u,y)=>C(y)?o(y):y,i=JSON.stringify(n,s,2);super(`${r}

viddy.${t}(...${i})
`),this.name="ViddyError"}};var j=(...e)=>f(e)(a([m])(pe),a([m,h])(([t,n])=>x([O({pattern:t},n)])),a([h])(x),d([]));function Rt(e){return(...t)=>f(t)(a([m])(([n])=>x([{selector:e,near:n}])),a([m,ze])(([n,r])=>x([{selector:e,near:M(O({},r),{pattern:n})}])),a([qe])(o=>{var[s]=o,i=s,{pattern:n}=i,r=I(i,["pattern"]);return x([{selector:e,near:M(O({},r),{pattern:n})}])}),a([{selector:c}])(o=>{var[s]=o,i=s,{selector:n}=i,r=I(i,["selector"]);return x([M(O({},r),{selector:n})])}),d([]))}function _t(e){return(...t)=>Te(n=>n.filter(ae(a(L(P(e)))(!0))))(f(t)(a([m])(([n])=>x([{containedBy:{selector:e},pattern:n}])),a([m,ze])(([n,r])=>x([M(O({},r),{containedBy:{selector:e},pattern:n})])),a([qe])(o=>{var[s]=o,i=s,{pattern:n}=i,r=I(i,["pattern"]);return x([M(O({},r),{containedBy:{selector:e},pattern:n})])}),a([Ve])(([n])=>x([M(O({},n),{containedBy:{selector:e}})])),a([{selector:c}])(o=>{var[s]=o,i=s,{selector:n}=i,r=I(i,["selector"]);return x([M(O({},r),{selector:n})])}),d(x([{selector:e}]))))}var ne=Rt($e),he=_t(It);function pe([e,t=We]){let n=f(e)(a(C)(De),d(Ae)),r=P(t).filter(Ne).filter(je).filter(n);return r.filter(o=>r.filter(i=>i!==o).every(i=>!o.contains(i)))}function x([e]){return f(e)(a({pattern:m,selector:c})(o=>{var s=o,{pattern:t,selector:n}=s,r=I(s,["pattern","selector"]);return te(pe([t,n]),r)}),a({pattern:m})(r=>{var o=r,{pattern:t}=o,n=I(o,["pattern"]);return te(pe([t]),n)}),a({selector:c})(r=>{var o=r,{selector:t}=o,n=I(o,["selector"]);return te(P(t),n)}),d(()=>te(P(We),e)))}var Wt=e=>O(O({},e),["near","above","below","leftOf","rightOf","containedBy"].reduce((t,n)=>M(O({},t),{[n]:f(e[n])(a(Nt)(j),a(p)(r=>j(...r)),d(null))}),{}));function te(e,t={}){let $=Wt(t),{near:n,containedBy:r,pickParent:o}=$,s=I($,["near","containedBy","pickParent"]),i=Object.keys(s).length>0,u=le(ke),y=le(Fe),T=({depth:l},w,[v])=>l===v.depth,U=p(r)?l=>{let w=l.map(y),v=E=>H=>H.map((g,q)=>({contained:g.contains(E),depth:q,el:E})).filter(({contained:g})=>g)[0];return E=>w.map(v(E))[0]}:()=>l=>({depth:0,el:l}),J=i?l=>{let{above:w,below:v,leftOf:E,rightOf:H}=Se(l,g=>p(g)?g.map(u):g);return g=>{let q=S=>S.filter(st=>st.el!==g),X=u(g),tt=!p(w)||q(w).every(S=>S.y>X.y),nt=!p(v)||q(v).every(S=>S.y<X.y),rt=!p(E)||q(E).every(S=>S.x>X.x),ot=!p(H)||q(H).every(S=>S.x<X.x);return tt&&nt&&rt&&ot}}:()=>()=>!0,Q=p(n)?l=>{let w=l.map(u);return v=>{let E=w.filter(g=>g.el!==v),H=u(v);return E.map(g=>({from:v,distance:Le(g,H)}))[0]}}:()=>l=>({distance:0,from:l}),B=c(o)?l=>{let w=P(l);return v=>y(v).find(E=>w.includes(E))}:()=>R;return e.map(U(r)).filter(Boolean).sort(ue("depth")).filter(T).map(({el:l})=>l).filter(J(s)).map(Q(n)).filter(Boolean).sort(ue("distance")).map(({from:l})=>l).map(B(o)).filter(Boolean)}function Ue(...e){return!!j(...e)[0]}function Je(...e){return j(...e).map(G)}function Qe(...e){return ne(...e).map(me)}function ye(...e){return j(...e).map(t=>t.innerText)}function Ge(e,...t){let n=f(t)(a(Pt)(()=>[e]),a([p])(([r])=>r),a([m])(([r])=>({pattern:r})),a([Ve])(([r])=>[M(O({},r),{pattern:e})]),d(()=>t));return ye(...n).map(r=>f(e)(a(C)(o=>{var i;let s=(i=r.match(o))!=null?i:[void 0];return s.length>1||s.groups!==void 0?s:s[0]}),a(c)(r),d(null))).filter(L(c,p))}function ge(e="baseWaitFor",t,...n){let r=f(n)(a([{timeoutInMs:V(N)}])(R),a([m,{timeoutInMs:V(N)}])(R),a([m,m,{timeoutInMs:V(N)}])(R),d(He*1e3)),o=new W(e,n,{message:`timed out after ${r}ms trying to resolve query`});return new Promise((s,i)=>{let u=$=>(s($),J()),y=()=>(i(o),J()),T=t({done:u,args:n}),U=setTimeout(y,r),J=()=>{clearTimeout(U),B(),Q()},Q=Re($e,T),B=fe(T);T()})}function Xe(...e){return ge("waitFor",t,...e);function t({args:n,done:r}){return()=>{let o=j(...n);o.length&&r(o.map(G))}}}function Ke(...e){return ge("waitForCta",t,...e);function t({args:n,done:r}){return()=>{let o=he(...n);o.length&&r(o.map(G))}}}function Ye(e,...t){if(!t.length)throw new W("waitForValue",t,{message:"no query specified"});return ge("waitForValue",n,e,...t);function n({args:r,done:o}){return()=>{let s=ne(...r.slice(1)).map(i=>({el:i,value:me(i)})).filter(({value:i})=>f([e,i])(a([C,c])(([u])=>u.test(i)),a([c,c])(([u])=>u.toLowerCase()===i.toLowerCase()))).map(({el:i})=>i);s.length&&o(s.map(G))}}}var _e=L(b(h,{withinMs:N}),b(h,{timeoutInMs:N}),b(h,{withinMs:N,timeoutInMs:N}));function Ze(...e){let t=f(e)(a([V(_e)])(R),a([m,V(_e)])(R),d({})),{withinMs:n=Ct}=t,{timeoutInMs:r=He*1e3}=t,o=Math.max(r,n+16),s=new W("waitForIdle",e,{message:`timed out after ${o}ms waiting for DOM idle`}),i=f(e)(a([m])(!0),a([jt])(!0),a([m,h])(!0),d(!1)),u=i&&et.selectorOf(...e);if(i&&!u)throw new W("waitForIdle",e,{message:"need resolvable query to monitor for DOM idle, or omit query to monitor all DOM changes"});return new Promise((y,T)=>{let U=()=>(y(),l()),Q=setTimeout(()=>(T(s),l()),o),[B,$]=ee(n,U),l=()=>{clearTimeout(Q),$(),w()},w=fe(B,u);B()})}function _(e){return(...t)=>e(...t)[0]}var et={for:_(j),forCta:_(he),forInput:_(ne),selectorOf:_(Je),valueOf:_(Qe),waitFor:(...e)=>Xe(...e).then(t=>t[0]),waitForCta:(...e)=>Ke(...e).then(t=>t[0]),waitForValue:(...e)=>Ye(...e).then(t=>t[0]),waitForIdle:Ze,innerText:_(ye),matchText:_(Ge),hasContent:Ue},Bt={for:j,forInput:ne,forCta:he,selectorOf:Je,valueOf:Qe,waitFor:Xe,waitForCta:Ke,waitForValue:Ye,waitForIdle:Ze,innerText:ye,matchText:Ge,hasContent:Ue};return ft($t);})();
