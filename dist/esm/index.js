/*
 * viddy
 * v2.0.3
 * https://github.com/shuckster/viddy
 * License: MIT
 */
var er=Object.create;var xe=Object.defineProperty,tr=Object.defineProperties,rr=Object.getOwnPropertyDescriptor,nr=Object.getOwnPropertyDescriptors,or=Object.getOwnPropertyNames,ue=Object.getOwnPropertySymbols,ir=Object.getPrototypeOf,Ee=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var ze=(e,t,r)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,L=(e,t)=>{for(var r in t||(t={}))Ee.call(t,r)&&ze(e,r,t[r]);if(ue)for(var r of ue(t))Ve.call(t,r)&&ze(e,r,t[r]);return e},F=(e,t)=>tr(e,nr(t));var R=(e,t)=>{var r={};for(var n in e)Ee.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&ue)for(var n of ue(e))t.indexOf(n)<0&&Ve.call(e,n)&&(r[n]=e[n]);return r};var z=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ar=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of or(t))!Ee.call(e,o)&&o!==r&&xe(e,o,{get:()=>t[o],enumerable:!(n=rr(t,o))||n.enumerable});return e};var sr=(e,t,r)=>(r=e!=null?er(ir(e)):{},ar(t||!e||!e.__esModule?xe(r,"default",{value:e,enumerable:!0}):r,e));var Ce=z((de,st)=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});var pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at=function(){function e(t,r){var n=[],o=!0,i=!1,a=void 0;try{for(var c=t[Symbol.iterator](),s;!(o=(s=c.next()).done)&&(n.push(s.value),!(r&&n.length===r));o=!0);}catch(u){i=!0,a=u}finally{try{!o&&c.return&&c.return()}finally{if(i)throw a}}return n}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();de.default=Ir;function Ir(e,t){if(global.document)return!1;global.document=t.context||function(){for(var n=e;n.parent;)n=n.parent;return n}();var r=Object.getPrototypeOf(global.document);return Object.getOwnPropertyDescriptor(r,"childTags")||Object.defineProperty(r,"childTags",{enumerable:!0,get:function(){return this.children.filter(function(o){return o.type==="tag"||o.type==="script"||o.type==="style"})}}),Object.getOwnPropertyDescriptor(r,"attributes")||Object.defineProperty(r,"attributes",{enumerable:!0,get:function(){var o=this.attribs,i=Object.keys(o),a=i.reduce(function(c,s,u){return c[u]={name:s,value:o[s]},c},{});return Object.defineProperty(a,"length",{enumerable:!1,configurable:!1,value:i.length}),a}}),r.getAttribute||(r.getAttribute=function(n){return this.attribs[n]||null}),r.getElementsByTagName||(r.getElementsByTagName=function(n){var o=[];return B(this.childTags,function(i){(i.name===n||n==="*")&&o.push(i)}),o}),r.getElementsByClassName||(r.getElementsByClassName=function(n){var o=n.trim().replace(/\s+/g," ").split(" "),i=[];return B([this],function(a){var c=a.attribs.class;c&&o.every(function(s){return c.indexOf(s)>-1})&&i.push(a)}),i}),r.querySelectorAll||(r.querySelectorAll=function(n){var o=this;n=n.replace(/(>)(\S)/g,"$1 $2").trim();var i=Nr(n),a=i.shift(),c=i.length;return a(this).filter(function(s){for(var u=0;u<c;){if(s=i[u](s,o),!s)return!1;u+=1}return!0})}),r.contains||(r.contains=function(n){var o=!1;return B([this],function(i,a){i===n&&(o=!0,a())}),o}),!0}function Nr(e){return e.split(" ").reverse().map(function(t,r){var n=r===0,o=t.split(":"),i=at(o,2),a=i[0],c=i[1],s=null,u=null;if(function(){switch(!0){case/>/.test(a):u=function(l){return function(S){return S(l.parent)&&l.parent}};break;case/^\./.test(a):var y=a.substr(1).split(".");s=function(l){var S=l.attribs.class;return S&&y.every(function(M){return S.indexOf(M)>-1})},u=function(l,S){return n?l.getElementsByClassName(y.join(" ")):typeof l=="function"?l(s):ie(l,S,s)};break;case/^\[/.test(a):var m=a.replace(/\[|\]|"/g,"").split("="),w=at(m,2),v=w[0],p=w[1];s=function(l){var S=Object.keys(l.attribs).indexOf(v)>-1;return!!(S&&(!p||l.attribs[v]===p))},u=function(l,S){if(n){var M=function(){var N=[];return B([l],function(P){s(P)&&N.push(P)}),{v:N}}();if((typeof M=="undefined"?"undefined":pe(M))==="object")return M.v}return typeof l=="function"?l(s):ie(l,S,s)};break;case/^#/.test(a):var E=a.substr(1);s=function(l){return l.attribs.id===E},u=function(l,S){if(n){var M=function(){var N=[];return B([l],function(P,Se){s(P)&&(N.push(P),Se())}),{v:N}}();if((typeof M=="undefined"?"undefined":pe(M))==="object")return M.v}return typeof l=="function"?l(s):ie(l,S,s)};break;case/\*/.test(a):s=function(l){return!0},u=function(l,S){if(n){var M=function(){var N=[];return B([l],function(P){return N.push(P)}),{v:N}}();if((typeof M=="undefined"?"undefined":pe(M))==="object")return M.v}return typeof l=="function"?l(s):ie(l,S,s)};break;default:s=function(l){return l.name===a},u=function(l,S){if(n){var M=function(){var N=[];return B([l],function(P){s(P)&&N.push(P)}),{v:N}}();if((typeof M=="undefined"?"undefined":pe(M))==="object")return M.v}return typeof l=="function"?l(s):ie(l,S,s)}}}(),!c)return u;var d=c.match(/-(child|type)\((\d+)\)$/),h=d[1],b=parseInt(d[2],10)-1,O=function(m){if(m){var w=m.parent.childTags;h==="type"&&(w=w.filter(s));var v=w.findIndex(function(p){return p===m});if(v===b)return!0}return!1};return function(m){var w=u(m);return n?w.reduce(function(v,p){return O(p)&&v.push(p),v},[]):O(w)&&w}})}function B(e,t){e.forEach(function(r){var n=!0;t(r,function(){return n=!1}),r.childTags&&n&&B(r.childTags,t)})}function ie(e,t,r){for(;e.parent;){if(e=e.parent,r(e))return e;if(e===t)break}return null}st.exports=de.default});var ve=z(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.convertNodeList=Lr;me.escapeValue=Pr;function Lr(e){for(var t=e.length,r=new Array(t),n=0;n<t;n++)r[n]=e[n];return r}function Pr(e){return e&&e.replace(/['"`\\/:\?&!#$%^()[\]{|}*+;,.<=>@~]/g,"\\$&").replace(/\n/g,"A")}});var gt=z((he,ht)=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.default=jr;var ft=ve(),ut={attribute:function(t){return["style","data-reactid","data-react-checksum"].indexOf(t)>-1}};function jr(e,t){var r=t.root,n=r===void 0?document:r,o=t.skip,i=o===void 0?null:o,a=t.priority,c=a===void 0?["id","class","href","src"]:a,s=t.ignore,u=s===void 0?{}:s,d=[],h=e,b=d.length,O=!1,y=i&&(Array.isArray(i)?i:[i]).map(function(v){return typeof v!="function"?function(p){return p===v}:v}),m=function(p){return i&&y.some(function(E){return E(p)})};for(Object.keys(u).forEach(function(v){v==="class"&&(O=!0);var p=u[v];typeof p!="function"&&(typeof p=="number"&&(p=p.toString()),typeof p=="string"&&(p=new RegExp((0,ft.escapeValue)(p).replace(/\\/g,"\\\\"))),typeof p=="boolean"&&(p=p?/(?:)/:/.^/),u[v]=function(E,g){return p.test(g)})}),O&&function(){var v=u.attribute;u.attribute=function(p,E,g){return u.class(E)||v&&v(p,E,g)}}();h!==n;){if(m(h)!==!0){if(ct(c,h,u,d,n)||lt(h,u,d,n))break;ct(c,h,u,d),d.length===b&&lt(h,u,d),d.length===b&&qr(c,h,u,d)}h=h.parentNode,b=d.length}if(h===n){var w=mt(c,h,u);d.unshift(w)}return d.join(" ")}function ct(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:t.parentNode,i=pt(e,t,r);if(i){var a=o.querySelectorAll(i);if(a.length===1)return n.unshift(i),!0}return!1}function pt(e,t,r){for(var n=t.attributes,o=Object.keys(n).sort(function(m,w){var v=e.indexOf(n[m].name),p=e.indexOf(n[w].name);return p===-1?v===-1?0:-1:v-p}),i=0,a=o.length;i<a;i++){var c=o[i],s=n[c],u=s.name,d=(0,ft.escapeValue)(s.value),h=r[u]||r.attribute,b=ut[u]||ut.attribute;if(!vt(h,u,d,b)){var O="["+u+'="'+d+'"]';if(/\b\d/.test(d)===!1&&(u==="id"&&(O="#"+d),u==="class")){var y=d.trim().replace(/\s+/g,".");O="."+y}return O}}return null}function lt(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.parentNode,o=dt(e,t);if(o){var i=n.getElementsByTagName(o);if(i.length===1)return r.unshift(o),!0}return!1}function dt(e,t){var r=e.tagName.toLowerCase();return vt(t.tag,null,r)?null:r}function qr(e,t,r,n){for(var o=t.parentNode,i=o.childTags||o.children,a=0,c=i.length;a<c;a++){var s=i[a];if(s===t){var u=mt(e,s,r);if(!u)return console.warn(`
          Element couldn't be matched through strict ignore pattern!
        `,s,r,u);var d="> "+u+":nth-child("+(a+1)+")";return n.unshift(d),!0}}return!1}function mt(e,t,r){var n=pt(e,t,r);return n||(n=dt(t,r)),n}function vt(e,t,r,n){if(!r)return!0;var o=e||n;return o?o(t,r,n):!1}ht.exports=he.default});var Ie=z((ye,yt)=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.default=Wr;var Fr=Ce(),Dr=$r(Fr),Rr=ve();function $r(e){return e&&e.__esModule?e:{default:e}}function Wr(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Array.isArray(t)||(t=t.length?(0,Rr.convertNodeList)(t):[t]),!t.length||t.some(function(h){return h.nodeType!==1}))throw new Error('Invalid input - to compare HTMLElements its necessary to provide a reference of the selected node(s)! (missing "elements")');var n=(0,Dr.default)(t[0],r),o=e.replace(/> /g,">").split(/\s+(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(o.length<2)return ge("",e,"",t);for(var i=[o.pop()];o.length>1;){var a=o.pop(),c=o.join(" "),s=i.join(" "),u=c+" "+s,d=document.querySelectorAll(u);d.length!==t.length&&i.unshift(ge(c,a,s,t))}return i.unshift(o[0]),o=i,o[0]=ge("",o[0],o.slice(1).join(" "),t),o[o.length-1]=ge(o.slice(0,-1).join(" "),o[o.length-1],"",t),n&&delete global.document,o.join(" ").replace(/>/g,"> ").trim()}function ge(e,t,r,n){if(e.length&&(e=e+" "),r.length&&(r=" "+r),/\[*\]/.test(t)){var o=t.replace(/=.*$/,"]"),i=""+e+o+r,a=document.querySelectorAll(i);if(te(a,n))t=o;else for(var c=document.querySelectorAll(""+e+o),s=function(){var g=c[u];if(n.some(function(S){return g.contains(S)})){var l=g.tagName.toLowerCase();return i=""+e+l+r,a=document.querySelectorAll(i),te(a,n)&&(t=l),"break"}},u=0,d=c.length;u<d;u++){var i,a,h=s();if(h==="break")break}}if(/>/.test(t)){var b=t.replace(/>/,""),i=""+e+b+r,a=document.querySelectorAll(i);te(a,n)&&(t=b)}if(/:nth-child/.test(t)){var O=t.replace(/nth-child/g,"nth-of-type"),i=""+e+O+r,a=document.querySelectorAll(i);te(a,n)&&(t=O)}if(/\.\S+\.\S+/.test(t)){for(var y=t.trim().split(".").slice(1).map(function(E){return"."+E}).sort(function(E,g){return E.length-g.length});y.length;){var m=t.replace(y.shift(),"").trim(),i=(""+e+m+r).trim();if(!i.length||i.charAt(0)===">"||i.charAt(i.length-1)===">")break;var a=document.querySelectorAll(i);te(a,n)&&(t=m)}if(y=t&&t.match(/\./g),y&&y.length>2)for(var w=document.querySelectorAll(""+e+t),v=function(){var g=w[u];if(n.some(function(S){return g.contains(S)})){var l=g.tagName.toLowerCase();return i=""+e+l+r,a=document.querySelectorAll(i),te(a,n)&&(t=l),"break"}},u=0,d=w.length;u<d;u++){var i,a,p=v();if(p==="break")break}}return t}function te(e,t){var r=e.length;return r===t.length&&t.every(function(n){for(var o=0;o<r;o++)if(e[o]===n)return!0;return!1})}yt.exports=ye.default});var Ne=z(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.getCommonAncestor=Br;be.getCommonProperties=Hr;function Br(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.root,n=r===void 0?document:r,o=[];e.forEach(function(h,b){for(var O=[];h!==n;)h=h.parentNode,O.unshift(h);o[b]=O}),o.sort(function(h,b){return h.length-b.length});for(var i=o.shift(),a=null,c=function(){var b=i[s],O=o.some(function(y){return!y.some(function(m){return m===b})});if(O)return"break";a=b},s=0,u=i.length;s<u;s++){var d=c();if(d==="break")break}return a}function Hr(e){var t={classes:[],attributes:{},tag:null};return e.forEach(function(r){var n=t.classes,o=t.attributes,i=t.tag;if(n!==void 0){var a=r.getAttribute("class");a?(a=a.trim().split(" "),n.length?(n=n.filter(function(s){return a.some(function(u){return u===s})}),n.length?t.classes=n:delete t.classes):t.classes=a):delete t.classes}if(o!==void 0&&function(){var s=r.attributes,u=Object.keys(s).reduce(function(b,O){var y=s[O],m=y.name;return y&&m!=="class"&&(b[m]=y.value),b},{}),d=Object.keys(u),h=Object.keys(o);d.length?h.length?(o=h.reduce(function(b,O){var y=o[O];return y===u[O]&&(b[O]=y),b},{}),Object.keys(o).length?t.attributes=o:delete t.attributes):t.attributes=u:delete t.attributes}(),i!==void 0){var c=r.tagName.toLowerCase();i?c!==i&&delete t.tag:t.tag=c}}),t}});var Et=z(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});var zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};ae.getSingleSelector=Pe;ae.getMultiSelector=xt;ae.default=Xr;var Vr=Ce(),Ot=Le(Vr),Ur=gt(),Qr=Le(Ur),Jr=Ie(),wt=Le(Jr),bt=ve(),St=Ne();function Le(e){return e&&e.__esModule?e:{default:e}}function Pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.nodeType===3&&(e=e.parentNode),e.nodeType!==1)throw new Error('Invalid input - only HTMLElements or representations of them are supported! (not "'+(typeof e=="undefined"?"undefined":zr(e))+'")');var r=(0,Ot.default)(e,t),n=(0,Qr.default)(e,t),o=(0,wt.default)(n,e,t);return r&&delete global.document,o}function xt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Array.isArray(e)||(e=(0,bt.convertNodeList)(e)),e.some(function(u){return u.nodeType!==1}))throw new Error("Invalid input - only an Array of HTMLElements or representations of them is supported!");var r=(0,Ot.default)(e[0],t),n=(0,St.getCommonAncestor)(e,t),o=Pe(n,t),i=Gr(e),a=i[0],c=(0,wt.default)(o+" "+a,e,t),s=(0,bt.convertNodeList)(document.querySelectorAll(c));return e.every(function(u){return s.some(function(d){return d===u})})?(r&&delete global.document,c):console.warn(`
      The selected elements can't be efficiently mapped.
      Its probably best to use multiple single selectors instead!
    `,e)}function Gr(e){var t=(0,St.getCommonProperties)(e),r=t.classes,n=t.attributes,o=t.tag,i=[];if(o&&i.push(o),r){var a=r.map(function(s){return"."+s}).join("");i.push(a)}if(n){var c=Object.keys(n).reduce(function(s,u){return s.push("["+u+'="'+n[u]+'"]'),s},[]).join("");i.push(c)}return i.length,[i.join("")]}function Xr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.length&&!e.name?xt(e,t):Pe(e,t)}});var At=z(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.default=I.common=I.optimize=I.getMultiSelector=I.getSingleSelector=I.select=void 0;var je=Et();Object.defineProperty(I,"getSingleSelector",{enumerable:!0,get:function(){return je.getSingleSelector}});Object.defineProperty(I,"getMultiSelector",{enumerable:!0,get:function(){return je.getMultiSelector}});var Mt=kt(je),Yr=Ie(),Kr=kt(Yr),Zr=Ne(),en=tn(Zr);function tn(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function kt(e){return e&&e.__esModule?e:{default:e}}I.select=Mt.default;I.optimize=Kr.default;I.common=en;I.default=Mt.default});var ur=Object.defineProperty;var cr=(e,t)=>{for(var r in t)ur(e,r,{get:t[r],enumerable:!0})},ce={};cr(ce,{instanceOf:()=>K,isArguments:()=>Ge,isArray:()=>fr,isDate:()=>pr,isFormData:()=>Or,isFunction:()=>Xe,isIterable:()=>br,isMap:()=>gr,isNumber:()=>mr,isObject:()=>Ye,isPojo:()=>yr,isRegExp:()=>vr,isSet:()=>hr,isString:()=>dr});var Je=Object.prototype,lr=Je.toString,le=e=>t=>typeof t===e,K=e=>t=>t instanceof e,{isArray:fr}=Array,Ge=e=>lr.call(e)==="[object Arguments]",pr=e=>K(Date)(e)&&!isNaN(e),Xe=le("function"),dr=le("string"),mr=e=>e===e&&le("number")(e),Ye=e=>e!==null&&le("object")(e),vr=K(RegExp),hr=K(Set),gr=K(Map),yr=e=>e===null||!Ye(e)||Ge(e)?!1:Object.getPrototypeOf(e)===Je,br=e=>e!=null&&[e[Symbol.iterator],e.next].every(Xe),Or=e=>typeof FormData!="undefined"&&K(FormData)(e),{isArguments:wr,isArray:_,isDate:hn,isFunction:U,isNumber:W}=ce,{isPojo:C,isRegExp:$,isString:x,instanceOf:gn}=ce,{isMap:Sr,isSet:xr,isIterable:Er,isFormData:Mr}=ce,{keys:Ke,entries:yn,assign:bn}=Object,Ue=2e4;function A(e){return(...t)=>ke(...t)(e)}var ke=(...e)=>t=>{let[r,n]=wr(t)?[{},Array.from(t)]:Sr(t)||Mr(t)?[{isMap:!0},t.entries()]:xr(t)?[{isSet:!0},t.values()]:[{},t];if(!Er(n))return Qe(...e)(n).result;let[o,i]=e.reduce(([c,s],u)=>kr(u)?[u,s]:[c,[...s,u]],[()=>({value:()=>{}}),[]]),a=[];do{let{value:c,done:s}=n.next();if(s)return o().value();a.push(c);let{found:u,result:d}=Qe(...i)(r.isSet?c:r.isMap?{key:c[0],value:c[1]}:[...a]);if(u)return d}while(a.length<Ue||r.isSet||r.isMap);throw new Error(`Hit iterationLimit: ${Ue}. Use setIterationLimit(Infinity) to disable.`)},Qe=(...e)=>{let t;return r=>({found:!!e.find(n=>{let o=n(r),{matched:i,value:a}=o||{};return[i,a].every(U)?i(r)&&(t=a(r),!0):o&&(t=o)}),result:t})},Ze=Symbol("@@match-iz/otherwise"),kr=e=>(e==null?void 0:e[Ze])===!0,T=e=>{let t=r=>({matched:()=>!0,value:()=>U(e)?e(r):e});return t[Ze]=!0,t},Me=e=>t=>r=>({matched:()=>V(e,r,n=>r=n),value:()=>U(t)?x(r)&&$(e)?t(...Ar(r.match(e))):t(r):t}),f=(...e)=>{if(e.length===1){let[t]=e;return Me(t)}if(e.length===2){let[t,r]=e;return Me(t)(r)}if(e.length>2){let t=e.slice(-1)[0],r=e.slice(0,-1);return Me(j(r))(t)}throw new Error("Expected at least 1 argument")},Ar=e=>{let{groups:t}=e;return t?[t,e]:[e]},V=(e,t,r)=>C(e)?Ke(e).every(n=>V(e[n],t==null?void 0:t[n],r)):_(e)?_(t)&&e.length===t.length&&e.every((n,o)=>V(n,t==null?void 0:t[o],r)):U(e)?e(t,r):x(t)&&$(e)?e.test(t):e===t||[e,t].every(Number.isNaN),Z=(...e)=>(t,r)=>e.length===0||(U(e[0])?e[0](t):V(e[0],t,r))?(r(t),!0):!1;var ee=e=>(t,r)=>!V(e,t,r),Q=(...e)=>(t,r)=>e.flat().some(n=>V(n,t,r)),j=(...e)=>(t,r)=>e.flat().every(n=>V(n,t,r));var Ae=e=>e!==e||!e&&e!==0&&e!==!1||_(e)&&!e.length||C(e)&&!Ke(e).length,et=e=>!Ae(e);var tt=e=>_r(t=>t.includes(e));var _r=e=>(t,r)=>(_(t)||x(t))&&e(t,r);var _e=e=>x(e)?(t,r)=>t[e]-r[e]:(t,r)=>t-r;function fe(e,t){let[r,n]=Tr(e,t);return[(...i)=>(n(),r(...i)),n]}function Tr(e,t){let r;return[(...i)=>{r=setTimeout(t,e,...i)},()=>clearTimeout(r)]}var rt=(...e)=>t=>e.reduceRight((r,n)=>n(r),t);function Te(e,t=new Map){return r=>t.has(r)?t.get(r):t.set(r,e(r)).get(r)}var nt=(e,t)=>Object.entries(e).reduce((r,[n,o])=>(r[n]=t(o,n),r),{}),X=e=>e,J=()=>({valueOf:()=>{},toString:()=>"Nothing",map:()=>J(),chain:()=>J(),fork:e=>e(),orElse:e=>e(),ap:()=>J()});J.of=()=>J();var G=e=>({valueOf:()=>e,toString:()=>`Just(${e})`,map:t=>G(t(e)),chain:t=>t(e),fork:(t,r)=>r(e),orElse:()=>G(e),ap:t=>t.map(e)});G.of=e=>G(e);var Cr=(e=t=>t!=null)=>{let t=r=>e(r)?G(r):J();return t.of=r=>t(r),t},ot=e=>{try{return G(e())}catch(t){return J()}},En=Cr(),it=e=>()=>G(e);var Tt=sr(At(),1),Ct=e=>e instanceof HTMLElement,It=e=>e.offsetParent!==null,H=e=>ot(()=>document.querySelectorAll(e)).map(Array.from).orElse(it([])).valueOf();function Nt(e){let t=[],r=e.parentNode;for(;r&&r!==document;)t.push(r),r=r.parentNode;return t}function Lt(e){let{top:t,left:r,width:n,height:o}=e.getBoundingClientRect(),i=n/2,a=o/2,c=r+i,s=t+a;return{el:e,x:c,y:s,halfWidth:i,halfHeight:a}}function Pt(e,t){let r=t.x-e.x,n=t.y-e.y,o=_t(r,n,e.x,e.y,e.halfWidth,e.halfHeight),i=_t(-r,-n,t.x,t.y,t.halfWidth,t.halfHeight);return Math.hypot(o.x-i.x,o.y-i.y)}function _t(e,t,r,n,o,i){return Math.abs(t/e)<i/o?{x:r+(e>0?o:-o),y:n+t*o/Math.abs(e)}:{x:r+e*i/Math.abs(t),y:n+(t>0?i:-i)}}function jt(e){let t=e.toLowerCase();return r=>r.textContent.toLowerCase().includes(t)&&r.innerText.toLowerCase().includes(t)}var qt=e=>t=>e.test(t.textContent)&&e.test(t.innerText);function se(e){if(e instanceof Element)return typeof global=="undefined"&&typeof window!="undefined"&&(global=window),(0,Tt.select)(e)}function qe(e){return A(e)(f({val:U})(t=>t.val()),f({tagName:"SELECT",multiple:!0})(({options:t})=>Array.from(t).reduce((r,n)=>n.selected?r.concat(n.value):r,[])),f({type:"checkbox",value:et})(t=>t.checked?t.value:""),f({type:"checkbox"})(t=>t.checked?"checked":""),f({contenteditable:!0})(t=>t.innerHTML),T(t=>t.value))}function Fe(e,t){let r=t?new MutationObserver(o):new MutationObserver(n);return r.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),()=>r.disconnect();function n(i){setTimeout(()=>e(i),1)}function o(i){let a=H(t);for(let c of i){let s=c.target;if(a.some(u=>s.contains(u))){setTimeout(()=>e(),1);break}}}}var Ft=(e,t)=>{let[r,n]=fe(32,t),o=H(e).map(i=>(i.addEventListener("change",r,{passive:!0}),()=>i.removeEventListener("change",r))).concat(()=>document.body.removeEventListener("click",r)).concat(()=>document.body.removeEventListener("keyup",r)).concat(n);return document.body.addEventListener("click",r,{passive:!0}),document.body.addEventListener("keyup",r,{passive:!0}),()=>o.forEach(i=>i())};var Rt="body *",$t=["button","submit","reset","file"],Wt=$t.map(e=>`input:not([type=${e}])`).concat("select","textarea").join(", "),rn=$t.map(e=>`input[type=${e}]`).concat("a","button").join(", "),Bt=5,nn=500,on=j(_,Ae),k=Q(x,$),an=Q(k,C),sn=Q(j(C,{pattern:k}),j(C,{selector:x})),Ht=j(C,{pattern:k,selector:ee(x)}),zt=j(C,{pattern:ee(k),selector:ee(x)}),Vt=j(C,{selector:ee(x),pickParent:ee(x)}),$e="|<-REGEXP::FLAGS->|",un=j(x,tt($e)),cn=e=>[e.source,e.flags].join($e),ln=e=>new RegExp(...e.split($e)),Wn=(...e)=>JSON.stringify(e,(t,r)=>A(r)(f($)(cn),T(r))),Bn=e=>JSON.parse(e,(t,r)=>A(r)(f(un)(ln),T(r))),oe=class extends Error{constructor(t,r,{message:n="could not resolve query to any elements"}={}){let o=c=>`/${c.source}/${c.flags}`,a=JSON.stringify(r,(c,s)=>$(s)?o(s):s,2);super(`${n}

viddy.${t}(...${a})
`),this.name="ViddyError"}};var Y=(...e)=>A(e)(f([k])(Re),f([k,C])(([t,r])=>q([L({pattern:t},r)])),f([C])(q),T([]));function fn(e){return(...t)=>A(t)(f([k])(([r])=>q([{selector:e,near:r}])),f([k,Vt])(([r,n])=>q([{selector:e,near:F(L({},n),{pattern:r})}])),f([Ht])(o=>{var[i]=o,a=i,{pattern:r}=a,n=R(a,["pattern"]);return q([{selector:e,near:F(L({},n),{pattern:r})}])}),f([{selector:x}])(o=>{var[i]=o,a=i,{selector:r}=a,n=R(a,["selector"]);return q([F(L({},n),{selector:r})])}),T([]))}function pn(e){return(...t)=>rt(r=>r.filter(ke(f(Q(H(e)),!0))))(A(t)(f([k])(([r])=>q([{containedBy:{selector:e},pattern:r}])),f([k,Vt])(([r,n])=>q([F(L({},n),{containedBy:{selector:e},pattern:r})])),f([Ht])(o=>{var[i]=o,a=i,{pattern:r}=a,n=R(a,["pattern"]);return q([F(L({},n),{containedBy:{selector:e},pattern:r})])}),f([zt])(([r])=>q([F(L({},r),{containedBy:{selector:e}})])),f([{selector:x}])(o=>{var[i]=o,a=i,{selector:r}=a,n=R(a,["selector"]);return q([F(L({},n),{selector:r})])}),T(q([{selector:e}]))))}var we=fn(Wt),We=pn(rn);function Re([e,t=Rt]){let r=A(e)(f($)(qt),T(jt)),n=H(t).filter(Ct).filter(It).filter(r);return n.filter(o=>n.filter(a=>a!==o).every(a=>!o.contains(a)))}function q([e]){return A(e)(f({pattern:k,selector:x})(o=>{var i=o,{pattern:t,selector:r}=i,n=R(i,["pattern","selector"]);return Oe(Re([t,r]),n)}),f({pattern:k})(n=>{var o=n,{pattern:t}=o,r=R(o,["pattern"]);return Oe(Re([t]),r)}),f({selector:x})(n=>{var o=n,{selector:t}=o,r=R(o,["selector"]);return Oe(H(t),r)}),T(()=>Oe(H(Rt),e)))}var dn=e=>L(L({},e),["near","above","below","leftOf","rightOf","containedBy"].reduce((t,r)=>F(L({},t),{[r]:A(e[r])(f(an)(Y),f(_)(n=>Y(...n)),T(null))}),{}));function Oe(e,t={}){let y=dn(t),{near:r,containedBy:n,pickParent:o}=y,i=R(y,["near","containedBy","pickParent"]),a=Object.keys(i).length>0,c=Te(Lt),s=Te(Nt),u=({depth:m},w,[v])=>m===v.depth,d=_(n)?m=>{let w=m.map(s),v=p=>E=>E.map((g,l)=>({contained:g.contains(p),depth:l,el:p})).filter(({contained:g})=>g)[0];return p=>w.map(v(p))[0]}:()=>m=>({depth:0,el:m}),h=a?m=>{let{above:w,below:v,leftOf:p,rightOf:E}=nt(m,g=>_(g)?g.map(c):g);return g=>{let l=D=>D.filter(Zt=>Zt.el!==g),S=c(g),M=!_(w)||w.length>0&&l(w).every(D=>D.y>S.y),N=!_(v)||v.length>0&&l(v).every(D=>D.y<S.y),P=!_(p)||p.length>0&&l(p).every(D=>D.x>S.x),Se=!_(E)||E.length>0&&l(E).every(D=>D.x<S.x);return M&&N&&P&&Se}}:()=>()=>!0,b=_(r)?m=>{let w=m.map(c);return v=>{let p=w.filter(g=>g.el!==v),E=c(v);return p.map(g=>({from:v,distance:Pt(g,E)}))[0]}}:()=>m=>({distance:0,from:m}),O=x(o)?m=>{let w=H(m);return v=>s(v).find(p=>w.includes(p))}:()=>X;return e.map(d(n)).filter(Boolean).sort(_e("depth")).filter(u).map(({el:m})=>m).filter(h(i)).map(b(r)).filter(Boolean).sort(_e("distance")).map(({from:m})=>m).map(O(o)).filter(Boolean)}function Ut(...e){return!!Y(...e)[0]}function Qt(...e){return we(...e).map(qe)}function Be(...e){return Y(...e).map(t=>t.innerText)}function Jt(e,...t){let r=A(t)(f(on)(()=>[e]),f([_])(([n])=>n),f([k])(([n])=>({pattern:n})),f([zt])(([n])=>[F(L({},n),{pattern:e})]),T(()=>t));return Be(...r).map(n=>A(e)(f($)(o=>{var a;let i=(a=n.match(o))!=null?a:[void 0];return i.length>1||i.groups!==void 0?i:i[0]}),f(x)(n),T(null))).filter(Q(x,_))}function He(e="baseWaitFor",t,...r){let n=A(r)(f([{timeoutInMs:Z(W)}])(X),f([k,{timeoutInMs:Z(W)}])(X),f([k,k,{timeoutInMs:Z(W)}])(X),T(Bt*1e3)),o=new oe(e,r,{message:`timed out after ${n}ms trying to resolve query`});return new Promise((i,a)=>{let c=y=>(i(y),h()),s=()=>(a(o),h()),u=t({done:c,args:r}),d=setTimeout(s,n),h=()=>{clearTimeout(d),O(),b()},b=Ft(Wt,u),O=Fe(u);u()})}function Gt(...e){return He("waitFor",t,...e);function t({args:r,done:n}){return()=>{let o=Y(...r);o.length&&n(o.map(se))}}}function Xt(...e){return He("waitForCta",t,...e);function t({args:r,done:n}){return()=>{let o=We(...r);o.length&&n(o.map(se))}}}function Yt(e,...t){if(!t.length)throw new oe("waitForValue",t,{message:"no query specified"});return He("waitForValue",r,e,...t);function r({args:n,done:o}){return()=>{let i=we(...n.slice(1)).map(a=>({el:a,value:qe(a)})).filter(({value:a})=>A([e,a])(f([$,x])(([c])=>c.test(a)),f([x,x])(([c])=>c.toLowerCase()===a.toLowerCase()))).map(({el:a})=>a);i.length&&o(i.map(se))}}}var Dt=Q(j(C,{withinMs:W}),j(C,{timeoutInMs:W}),j(C,{withinMs:W,timeoutInMs:W}));function Kt(...e){let{withinMs:t=nn,timeoutInMs:r=Bt*1e3}=A(e)(f([Z(Dt)])(X),f([k,Z(Dt)])(X),T({})),n=Math.max(r,t+16),o=new oe("waitForDomToIdle",e,{message:`timed out after ${n}ms waiting for DOM idle`}),i=A(e)(f([k])(!0),f([sn])(!0),f([k,C])(!0),T(!1)),a=i&&mn.for(...e);if(i&&!a)throw new oe("waitForDomToIdle",e,{message:"need resolvable query to monitor for DOM idle, or omit query to monitor all DOM changes"});return new Promise((c,s)=>{let u=()=>(c(),y()),h=setTimeout(()=>(s(o),y()),n),[b,O]=fe(t,u),y=()=>{clearTimeout(h),O(),m()},m=Fe(b,a);b()})}function re(e){return(...t)=>e(...t)[0]}function De(e){return e[0]}function ne(e){return(...t)=>e(...t).map(se)}var mn={for:re(ne(Y)),forCta:re(ne(We)),forInput:re(ne(we)),waitFor:(...e)=>Gt(...e).then(De),waitForCta:(...e)=>Xt(...e).then(De),waitForValue:(...e)=>Yt(...e).then(De),waitForDomToIdle:Kt,valueOf:re(Qt),innerText:re(Be),matchText:re(Jt),hasContent:Ut},Hn={for:ne(Y),forInput:ne(we),forCta:ne(We),waitFor:Gt,waitForCta:Xt,waitForValue:Yt,waitForDomToIdle:Kt,valueOf:Qt,innerText:Be,matchText:Jt,hasContent:Ut};export{oe as ViddyError,H as qsArray,se as selectorOfElement,Wn as serialize,Bn as unserialize,mn as viddy,Hn as viddyWell};
