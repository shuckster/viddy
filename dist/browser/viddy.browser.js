/*
 * viddy
 * v1.5.0
 * https://github.com/shuckster/viddy
 * License: MIT
 */
var libViddy=(()=>{var Yt=Object.create;var ne=Object.defineProperty,Kt=Object.defineProperties,Zt=Object.getOwnPropertyDescriptor,er=Object.getOwnPropertyDescriptors,tr=Object.getOwnPropertyNames,se=Object.getOwnPropertySymbols,rr=Object.getPrototypeOf,we=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var Be=(e,t,r)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P=(e,t)=>{for(var r in t||(t={}))we.call(t,r)&&Be(e,r,t[r]);if(se)for(var r of se(t))He.call(t,r)&&Be(e,r,t[r]);return e},F=(e,t)=>Kt(e,er(t));var D=(e,t)=>{var r={};for(var n in e)we.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&se)for(var n of se(e))t.indexOf(n)<0&&He.call(e,n)&&(r[n]=e[n]);return r};var V=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),nr=(e,t)=>{for(var r in t)ne(e,r,{get:t[r],enumerable:!0})},ze=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of tr(t))!we.call(e,o)&&o!==r&&ne(e,o,{get:()=>t[o],enumerable:!(n=Zt(t,o))||n.enumerable});return e};var or=(e,t,r)=>(r=e!=null?Yt(rr(e)):{},ze(t||!e||!e.__esModule?ne(r,"default",{value:e,enumerable:!0}):r,e)),ir=e=>ze(ne({},"__esModule",{value:!0}),e);var Te=V((fe,rt)=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});var le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt=function(){function e(t,r){var n=[],o=!0,i=!1,a=void 0;try{for(var c=t[Symbol.iterator](),s;!(o=(s=c.next()).done)&&(n.push(s.value),!(r&&n.length===r));o=!0);}catch(u){i=!0,a=u}finally{try{!o&&c.return&&c.return()}finally{if(i)throw a}}return n}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();fe.default=Or;function Or(e,t){if(global.document)return!1;global.document=t.context||function(){for(var n=e;n.parent;)n=n.parent;return n}();var r=Object.getPrototypeOf(global.document);return Object.getOwnPropertyDescriptor(r,"childTags")||Object.defineProperty(r,"childTags",{enumerable:!0,get:function(){return this.children.filter(function(o){return o.type==="tag"||o.type==="script"||o.type==="style"})}}),Object.getOwnPropertyDescriptor(r,"attributes")||Object.defineProperty(r,"attributes",{enumerable:!0,get:function(){var o=this.attribs,i=Object.keys(o),a=i.reduce(function(c,s,u){return c[u]={name:s,value:o[s]},c},{});return Object.defineProperty(a,"length",{enumerable:!1,configurable:!1,value:i.length}),a}}),r.getAttribute||(r.getAttribute=function(n){return this.attribs[n]||null}),r.getElementsByTagName||(r.getElementsByTagName=function(n){var o=[];return H(this.childTags,function(i){(i.name===n||n==="*")&&o.push(i)}),o}),r.getElementsByClassName||(r.getElementsByClassName=function(n){var o=n.trim().replace(/\s+/g," ").split(" "),i=[];return H([this],function(a){var c=a.attribs.class;c&&o.every(function(s){return c.indexOf(s)>-1})&&i.push(a)}),i}),r.querySelectorAll||(r.querySelectorAll=function(n){var o=this;n=n.replace(/(>)(\S)/g,"$1 $2").trim();var i=wr(n),a=i.shift(),c=i.length;return a(this).filter(function(s){for(var u=0;u<c;){if(s=i[u](s,o),!s)return!1;u+=1}return!0})}),r.contains||(r.contains=function(n){var o=!1;return H([this],function(i,a){i===n&&(o=!0,a())}),o}),!0}function wr(e){return e.split(" ").reverse().map(function(t,r){var n=r===0,o=t.split(":"),i=tt(o,2),a=i[0],c=i[1],s=null,u=null;if(function(){switch(!0){case/>/.test(a):u=function(l){return function(S){return S(l.parent)&&l.parent}};break;case/^\./.test(a):var b=a.substr(1).split(".");s=function(l){var S=l.attribs.class;return S&&b.every(function(k){return S.indexOf(k)>-1})},u=function(l,S){return n?l.getElementsByClassName(b.join(" ")):typeof l=="function"?l(s):oe(l,S,s)};break;case/^\[/.test(a):var v=a.replace(/\[|\]|"/g,"").split("="),w=tt(v,2),m=w[0],p=w[1];s=function(l){var S=Object.keys(l.attribs).indexOf(m)>-1;return!!(S&&(!p||l.attribs[m]===p))},u=function(l,S){if(n){var k=function(){var I=[];return H([l],function(L){s(L)&&I.push(L)}),{v:I}}();if((typeof k=="undefined"?"undefined":le(k))==="object")return k.v}return typeof l=="function"?l(s):oe(l,S,s)};break;case/^#/.test(a):var E=a.substr(1);s=function(l){return l.attribs.id===E},u=function(l,S){if(n){var k=function(){var I=[];return H([l],function(L,Oe){s(L)&&(I.push(L),Oe())}),{v:I}}();if((typeof k=="undefined"?"undefined":le(k))==="object")return k.v}return typeof l=="function"?l(s):oe(l,S,s)};break;case/\*/.test(a):s=function(l){return!0},u=function(l,S){if(n){var k=function(){var I=[];return H([l],function(L){return I.push(L)}),{v:I}}();if((typeof k=="undefined"?"undefined":le(k))==="object")return k.v}return typeof l=="function"?l(s):oe(l,S,s)};break;default:s=function(l){return l.name===a},u=function(l,S){if(n){var k=function(){var I=[];return H([l],function(L){s(L)&&I.push(L)}),{v:I}}();if((typeof k=="undefined"?"undefined":le(k))==="object")return k.v}return typeof l=="function"?l(s):oe(l,S,s)}}}(),!c)return u;var d=c.match(/-(child|type)\((\d+)\)$/),g=d[1],O=parseInt(d[2],10)-1,y=function(v){if(v){var w=v.parent.childTags;g==="type"&&(w=w.filter(s));var m=w.findIndex(function(p){return p===v});if(m===O)return!0}return!1};return function(v){var w=u(v);return n?w.reduce(function(m,p){return y(p)&&m.push(p),m},[]):y(w)&&w}})}function H(e,t){e.forEach(function(r){var n=!0;t(r,function(){return n=!1}),r.childTags&&n&&H(r.childTags,t)})}function oe(e,t,r){for(;e.parent;){if(e=e.parent,r(e))return e;if(e===t)break}return null}rt.exports=fe.default});var de=V(pe=>{"use strict";Object.defineProperty(pe,"__esModule",{value:!0});pe.convertNodeList=Sr;pe.escapeValue=xr;function Sr(e){for(var t=e.length,r=new Array(t),n=0;n<t;n++)r[n]=e[n];return r}function xr(e){return e&&e.replace(/['"`\\/:\?&!#$%^()[\]{|}*+;,.<=>@~]/g,"\\$&").replace(/\n/g,"A")}});var pt=V((ve,ft)=>{"use strict";Object.defineProperty(ve,"__esModule",{value:!0});ve.default=Er;var at=de(),nt={attribute:function(t){return["style","data-reactid","data-react-checksum"].indexOf(t)>-1}};function Er(e,t){var r=t.root,n=r===void 0?document:r,o=t.skip,i=o===void 0?null:o,a=t.priority,c=a===void 0?["id","class","href","src"]:a,s=t.ignore,u=s===void 0?{}:s,d=[],g=e,O=d.length,y=!1,b=i&&(Array.isArray(i)?i:[i]).map(function(m){return typeof m!="function"?function(p){return p===m}:m}),v=function(p){return i&&b.some(function(E){return E(p)})};for(Object.keys(u).forEach(function(m){m==="class"&&(y=!0);var p=u[m];typeof p!="function"&&(typeof p=="number"&&(p=p.toString()),typeof p=="string"&&(p=new RegExp((0,at.escapeValue)(p).replace(/\\/g,"\\\\"))),typeof p=="boolean"&&(p=p?/(?:)/:/.^/),u[m]=function(E,h){return p.test(h)})}),y&&function(){var m=u.attribute;u.attribute=function(p,E,h){return u.class(E)||m&&m(p,E,h)}}();g!==n;){if(v(g)!==!0){if(ot(c,g,u,d,n)||it(g,u,d,n))break;ot(c,g,u,d),d.length===O&&it(g,u,d),d.length===O&&kr(c,g,u,d)}g=g.parentNode,O=d.length}if(g===n){var w=ct(c,g,u);d.unshift(w)}return d.join(" ")}function ot(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:t.parentNode,i=st(e,t,r);if(i){var a=o.querySelectorAll(i);if(a.length===1)return n.unshift(i),!0}return!1}function st(e,t,r){for(var n=t.attributes,o=Object.keys(n).sort(function(v,w){var m=e.indexOf(n[v].name),p=e.indexOf(n[w].name);return p===-1?m===-1?0:-1:m-p}),i=0,a=o.length;i<a;i++){var c=o[i],s=n[c],u=s.name,d=(0,at.escapeValue)(s.value),g=r[u]||r.attribute,O=nt[u]||nt.attribute;if(!lt(g,u,d,O)){var y="["+u+'="'+d+'"]';if(/\b\d/.test(d)===!1&&(u==="id"&&(y="#"+d),u==="class")){var b=d.trim().replace(/\s+/g,".");y="."+b}return y}}return null}function it(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.parentNode,o=ut(e,t);if(o){var i=n.getElementsByTagName(o);if(i.length===1)return r.unshift(o),!0}return!1}function ut(e,t){var r=e.tagName.toLowerCase();return lt(t.tag,null,r)?null:r}function kr(e,t,r,n){for(var o=t.parentNode,i=o.childTags||o.children,a=0,c=i.length;a<c;a++){var s=i[a];if(s===t){var u=ct(e,s,r);if(!u)return console.warn(`
          Element couldn't be matched through strict ignore pattern!
        `,s,r,u);var d="> "+u+":nth-child("+(a+1)+")";return n.unshift(d),!0}}return!1}function ct(e,t,r){var n=st(e,t,r);return n||(n=ut(t,r)),n}function lt(e,t,r,n){if(!r)return!0;var o=e||n;return o?o(t,r,n):!1}ft.exports=ve.default});var Ce=V((he,dt)=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.default=Cr;var _r=Te(),Ar=Tr(_r),Mr=de();function Tr(e){return e&&e.__esModule?e:{default:e}}function Cr(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Array.isArray(t)||(t=t.length?(0,Mr.convertNodeList)(t):[t]),!t.length||t.some(function(g){return g.nodeType!==1}))throw new Error('Invalid input - to compare HTMLElements its necessary to provide a reference of the selected node(s)! (missing "elements")');var n=(0,Ar.default)(t[0],r),o=e.replace(/> /g,">").split(/\s+(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(o.length<2)return me("",e,"",t);for(var i=[o.pop()];o.length>1;){var a=o.pop(),c=o.join(" "),s=i.join(" "),u=c+" "+s,d=document.querySelectorAll(u);d.length!==t.length&&i.unshift(me(c,a,s,t))}return i.unshift(o[0]),o=i,o[0]=me("",o[0],o.slice(1).join(" "),t),o[o.length-1]=me(o.slice(0,-1).join(" "),o[o.length-1],"",t),n&&delete global.document,o.join(" ").replace(/>/g,"> ").trim()}function me(e,t,r,n){if(e.length&&(e=e+" "),r.length&&(r=" "+r),/\[*\]/.test(t)){var o=t.replace(/=.*$/,"]"),i=""+e+o+r,a=document.querySelectorAll(i);if(re(a,n))t=o;else for(var c=document.querySelectorAll(""+e+o),s=function(){var h=c[u];if(n.some(function(S){return h.contains(S)})){var l=h.tagName.toLowerCase();return i=""+e+l+r,a=document.querySelectorAll(i),re(a,n)&&(t=l),"break"}},u=0,d=c.length;u<d;u++){var i,a,g=s();if(g==="break")break}}if(/>/.test(t)){var O=t.replace(/>/,""),i=""+e+O+r,a=document.querySelectorAll(i);re(a,n)&&(t=O)}if(/:nth-child/.test(t)){var y=t.replace(/nth-child/g,"nth-of-type"),i=""+e+y+r,a=document.querySelectorAll(i);re(a,n)&&(t=y)}if(/\.\S+\.\S+/.test(t)){for(var b=t.trim().split(".").slice(1).map(function(E){return"."+E}).sort(function(E,h){return E.length-h.length});b.length;){var v=t.replace(b.shift(),"").trim(),i=(""+e+v+r).trim();if(!i.length||i.charAt(0)===">"||i.charAt(i.length-1)===">")break;var a=document.querySelectorAll(i);re(a,n)&&(t=v)}if(b=t&&t.match(/\./g),b&&b.length>2)for(var w=document.querySelectorAll(""+e+t),m=function(){var h=w[u];if(n.some(function(S){return h.contains(S)})){var l=h.tagName.toLowerCase();return i=""+e+l+r,a=document.querySelectorAll(i),re(a,n)&&(t=l),"break"}},u=0,d=w.length;u<d;u++){var i,a,p=m();if(p==="break")break}}return t}function re(e,t){var r=e.length;return r===t.length&&t.every(function(n){for(var o=0;o<r;o++)if(e[o]===n)return!0;return!1})}dt.exports=he.default});var Ne=V(ge=>{"use strict";Object.defineProperty(ge,"__esModule",{value:!0});ge.getCommonAncestor=Nr;ge.getCommonProperties=Ir;function Nr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.root,n=r===void 0?document:r,o=[];e.forEach(function(g,O){for(var y=[];g!==n;)g=g.parentNode,y.unshift(g);o[O]=y}),o.sort(function(g,O){return g.length-O.length});for(var i=o.shift(),a=null,c=function(){var O=i[s],y=o.some(function(b){return!b.some(function(v){return v===O})});if(y)return"break";a=O},s=0,u=i.length;s<u;s++){var d=c();if(d==="break")break}return a}function Ir(e){var t={classes:[],attributes:{},tag:null};return e.forEach(function(r){var n=t.classes,o=t.attributes,i=t.tag;if(n!==void 0){var a=r.getAttribute("class");a?(a=a.trim().split(" "),n.length?(n=n.filter(function(s){return a.some(function(u){return u===s})}),n.length?t.classes=n:delete t.classes):t.classes=a):delete t.classes}if(o!==void 0&&function(){var s=r.attributes,u=Object.keys(s).reduce(function(O,y){var b=s[y],v=b.name;return b&&v!=="class"&&(O[v]=b.value),O},{}),d=Object.keys(u),g=Object.keys(o);d.length?g.length?(o=g.reduce(function(O,y){var b=o[y];return b===u[y]&&(O[y]=b),O},{}),Object.keys(o).length?t.attributes=o:delete t.attributes):t.attributes=u:delete t.attributes}(),i!==void 0){var c=r.tagName.toLowerCase();i?c!==i&&delete t.tag:t.tag=c}}),t}});var bt=V(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var Pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};ie.getSingleSelector=Pe;ie.getMultiSelector=yt;ie.default=Dr;var Lr=Te(),mt=Ie(Lr),jr=pt(),qr=Ie(jr),Fr=Ce(),ht=Ie(Fr),vt=de(),gt=Ne();function Ie(e){return e&&e.__esModule?e:{default:e}}function Pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.nodeType===3&&(e=e.parentNode),e.nodeType!==1)throw new Error('Invalid input - only HTMLElements or representations of them are supported! (not "'+(typeof e=="undefined"?"undefined":Pr(e))+'")');var r=(0,mt.default)(e,t),n=(0,qr.default)(e,t),o=(0,ht.default)(n,e,t);return r&&delete global.document,o}function yt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Array.isArray(e)||(e=(0,vt.convertNodeList)(e)),e.some(function(u){return u.nodeType!==1}))throw new Error("Invalid input - only an Array of HTMLElements or representations of them is supported!");var r=(0,mt.default)(e[0],t),n=(0,gt.getCommonAncestor)(e,t),o=Pe(n,t),i=Rr(e),a=i[0],c=(0,ht.default)(o+" "+a,e,t),s=(0,vt.convertNodeList)(document.querySelectorAll(c));return e.every(function(u){return s.some(function(d){return d===u})})?(r&&delete global.document,c):console.warn(`
      The selected elements can't be efficiently mapped.
      Its probably best to use multiple single selectors instead!
    `,e)}function Rr(e){var t=(0,gt.getCommonProperties)(e),r=t.classes,n=t.attributes,o=t.tag,i=[];if(o&&i.push(o),r){var a=r.map(function(s){return"."+s}).join("");i.push(a)}if(n){var c=Object.keys(n).reduce(function(s,u){return s.push("["+u+'="'+n[u]+'"]'),s},[]).join("");i.push(c)}return i.length,[i.join("")]}function Dr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.length&&!e.name?yt(e,t):Pe(e,t)}});var St=V(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.default=N.common=N.optimize=N.getMultiSelector=N.getSingleSelector=N.select=void 0;var Le=bt();Object.defineProperty(N,"getSingleSelector",{enumerable:!0,get:function(){return Le.getSingleSelector}});Object.defineProperty(N,"getMultiSelector",{enumerable:!0,get:function(){return Le.getMultiSelector}});var Ot=wt(Le),Wr=Ce(),$r=wt(Wr),Br=Ne(),Hr=zr(Br);function zr(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function wt(e){return e&&e.__esModule?e:{default:e}}N.select=Ot.default;N.optimize=$r.default;N.common=Hr;N.default=Ot.default});var an={};nr(an,{ViddyError:()=>Z,qsArray:()=>$,serialize:()=>Zr,unserialize:()=>en,viddy:()=>Gt,viddyWell:()=>on});var ar=Object.defineProperty;var sr=(e,t)=>{for(var r in t)ar(e,r,{get:t[r],enumerable:!0})},xe={};sr(xe,{instanceOf:()=>Ee,isArguments:()=>Ue,isArray:()=>cr,isDate:()=>lr,isFunction:()=>fr,isNumber:()=>dr,isObject:()=>Qe,isPojo:()=>mr,isRegExp:()=>vr,isString:()=>pr});var Ve=Object.prototype,ur=Ve.toString,ue=e=>t=>typeof t===e,Ee=e=>t=>t instanceof e,{isArray:cr}=Array,Ue=e=>ur.call(e)==="[object Arguments]",lr=e=>Ee(Date)(e)&&!isNaN(e),fr=ue("function"),pr=ue("string"),dr=e=>e===e&&ue("number")(e),Qe=e=>e!==null&&ue("object")(e),vr=Ee(RegExp),mr=e=>e===null||!Qe(e)||Ue(e)?!1:Object.getPrototypeOf(e)===Ve,{isArray:M,isDate:un,isFunction:Q,isNumber:B}=xe,{isPojo:C,isRegExp:W,isString:x,instanceOf:cn}=xe,{keys:Je,entries:ln,assign:fn}=Object;function A(e){return(...t)=>ke(...t)(e)}var ke=(...e)=>{let t;return r=>e.find(n=>{let o=n(r),{matched:i,value:a}=o||{};return[i,a].every(Q)?i(r)&&(t=a(r),!0):o&&(t=o)})&&t},T=e=>t=>({matched:()=>!0,value:()=>Q(e)?e(t):e}),Se=e=>t=>r=>({matched:()=>U(e,r,n=>r=n),value:()=>Q(t)?x(r)&&W(e)?t(...hr(r.match(e))):t(r):t}),f=(...e)=>{if(e.length===1){let[t]=e;return Se(t)}if(e.length===2){let[t,r]=e;return Se(t)(r)}if(e.length>2){let t=e.slice(-1)[0],r=e.slice(0,-1);return Se(j(r))(t)}throw new Error("expected 1 or 2 arguments")},hr=e=>{let{groups:t}=e;return t?[t,e]:[e]},U=(e,t,r)=>C(e)?Je(e).every(n=>U(e[n],t==null?void 0:t[n],r)):M(e)?M(t)&&e.length===t.length&&e.every((n,o)=>U(n,t==null?void 0:t[o],r)):Q(e)?e(t,r):x(t)&&W(e)?e.test(t):e===t||[e,t].every(Number.isNaN),ee=(...e)=>(t,r)=>e.length===0||(Q(e[0])?e[0](t):U(e[0],t,r))?(r(t),!0):!1;var te=e=>(t,r)=>!U(e,t,r),J=(...e)=>(t,r)=>e.flat().some(n=>U(n,t,r)),j=(...e)=>(t,r)=>e.flat().every(n=>U(n,t,r));var _e=e=>e!==e||!e&&e!==0&&e!==!1||M(e)&&!e.length||C(e)&&!Je(e).length,Ge=e=>!_e(e);var Xe=e=>gr(t=>t.includes(e));var gr=e=>(t,r)=>(M(t)||x(t))&&e(t,r);var Ae=e=>x(e)?(t,r)=>t[e]-r[e]:(t,r)=>t-r;function ce(e,t){let[r,n]=yr(e,t);return[(...i)=>(n(),r(...i)),n]}function yr(e,t){let r;return[(...i)=>{r=setTimeout(t,e,...i)},()=>clearTimeout(r)]}var Ye=(...e)=>t=>e.reduceRight((r,n)=>n(r),t);function Me(e,t=new Map){return r=>t.has(r)?t.get(r):t.set(r,e(r)).get(r)}var Ke=(e,t)=>Object.entries(e).reduce((r,[n,o])=>(r[n]=t(o,n),r),{}),Y=e=>e,G=()=>({valueOf:()=>{},toString:()=>"Nothing",map:()=>G(),chain:()=>G(),fork:e=>e(),orElse:e=>e(),ap:()=>G()});G.of=()=>G();var X=e=>({valueOf:()=>e,toString:()=>`Just(${e})`,map:t=>X(t(e)),chain:t=>t(e),fork:(t,r)=>r(e),orElse:()=>X(e),ap:t=>t.map(e)});X.of=e=>X(e);var br=(e=t=>t!=null)=>{let t=r=>e(r)?X(r):G();return t.of=r=>t(r),t},Ze=e=>{try{return X(e())}catch(t){return G()}},hn=br(),et=e=>()=>X(e);var Et=or(St(),1),kt=e=>e instanceof HTMLElement,_t=e=>e.offsetParent!==null,$=e=>Ze(()=>document.querySelectorAll(e)).map(Array.from).orElse(et([])).valueOf();function At(e){let t=[],r=e.parentNode;for(;r&&r!==document;)t.push(r),r=r.parentNode;return t}function Mt(e){let{top:t,left:r,width:n,height:o}=e.getBoundingClientRect(),i=n/2,a=o/2,c=r+i,s=t+a;return{el:e,x:c,y:s,halfWidth:i,halfHeight:a}}function Tt(e,t){let r=t.x-e.x,n=t.y-e.y,o=xt(r,n,e.x,e.y,e.halfWidth,e.halfHeight),i=xt(-r,-n,t.x,t.y,t.halfWidth,t.halfHeight);return Math.hypot(o.x-i.x,o.y-i.y)}function xt(e,t,r,n,o,i){return Math.abs(t/e)<i/o?{x:r+(e>0?o:-o),y:n+t*o/Math.abs(e)}:{x:r+e*i/Math.abs(t),y:n+(t>0?i:-i)}}function Ct(e){let t=e.toLowerCase();return r=>r.textContent.toLowerCase().includes(t)&&r.innerText.toLowerCase().includes(t)}var Nt=e=>t=>e.test(t.textContent)&&e.test(t.innerText);function ae(e){if(e instanceof Element)return typeof global=="undefined"&&typeof window!="undefined"&&(global=window),(0,Et.select)(e)}function je(e){return A(e)(f({val:Q})(t=>t.val()),f({tagName:"SELECT",multiple:!0})(({options:t})=>Array.from(t).reduce((r,n)=>n.selected?r.concat(n.value):r,[])),f({type:"checkbox",value:Ge})(t=>t.checked?t.value:""),f({type:"checkbox"})(t=>t.checked?"checked":""),f({contenteditable:!0})(t=>t.innerHTML),T(t=>t.value))}function qe(e,t){let r=t?new MutationObserver(o):new MutationObserver(n);return r.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),()=>r.disconnect();function n(i){setTimeout(()=>e(i),1)}function o(i){let a=$(t);for(let c of i){let s=c.target;if(a.some(u=>s.contains(u))){setTimeout(()=>e(),1);break}}}}var It=(e,t)=>{let[r]=ce(32,t),n=$(e).map(o=>(o.addEventListener("change",r,{passive:!0}),()=>o.removeEventListener("change",r))).concat(()=>document.body.removeEventListener("click",r)).concat(()=>document.body.removeEventListener("keyup",r));return document.body.addEventListener("click",r,{passive:!0}),document.body.addEventListener("keyup",r,{passive:!0}),()=>n.forEach(o=>o())};var Lt="body *",jt=["button","submit","reset","file"],qt=jt.map(e=>`input:not([type=${e}])`).concat("select","textarea").join(", "),Vr=jt.map(e=>`input[type=${e}]`).concat("a","button").join(", "),Ft=5,Ur=500,Qr=j(M,_e),_=J(x,W),Jr=J(_,C),Gr=J(j(C,{pattern:_}),j(C,{selector:x})),Rt=j(C,{pattern:_,selector:te(x)}),Dt=j(C,{pattern:te(_),selector:te(x)}),Wt=j(C,{selector:te(x),pickParent:te(x)}),Re="|<-REGEXP::FLAGS->|",Xr=j(x,Xe(Re)),Yr=e=>[e.source,e.flags].join(Re),Kr=e=>new RegExp(...e.split(Re)),Zr=(...e)=>JSON.stringify(e,(t,r)=>A(r)(f(W)(Yr),T(r))),en=e=>JSON.parse(e,(t,r)=>A(r)(f(Xr)(Kr),T(r))),Z=class extends Error{constructor(t,r,{message:n="could not resolve query to any elements"}){let o=c=>`/${c.source}/${c.flags}`,i=(c,s)=>W(s)?o(s):s,a=JSON.stringify(r,i,2);super(`${n}

viddy.${t}(...${a})
`),this.name="ViddyError"}};var z=(...e)=>A(e)(f([_])(Fe),f([_,C])(([t,r])=>q([P({pattern:t},r)])),f([C])(q),T([]));function tn(e){return(...t)=>A(t)(f([_])(([r])=>q([{selector:e,near:r}])),f([_,Wt])(([r,n])=>q([{selector:e,near:F(P({},n),{pattern:r})}])),f([Rt])(o=>{var[i]=o,a=i,{pattern:r}=a,n=D(a,["pattern"]);return q([{selector:e,near:F(P({},n),{pattern:r})}])}),f([{selector:x}])(o=>{var[i]=o,a=i,{selector:r}=a,n=D(a,["selector"]);return q([F(P({},n),{selector:r})])}),T([]))}function rn(e){return(...t)=>Ye(r=>r.filter(ke(f(J($(e)))(!0))))(A(t)(f([_])(([r])=>q([{containedBy:{selector:e},pattern:r}])),f([_,Wt])(([r,n])=>q([F(P({},n),{containedBy:{selector:e},pattern:r})])),f([Rt])(o=>{var[i]=o,a=i,{pattern:r}=a,n=D(a,["pattern"]);return q([F(P({},n),{containedBy:{selector:e},pattern:r})])}),f([Dt])(([r])=>q([F(P({},r),{containedBy:{selector:e}})])),f([{selector:x}])(o=>{var[i]=o,a=i,{selector:r}=a,n=D(a,["selector"]);return q([F(P({},n),{selector:r})])}),T(q([{selector:e}]))))}var be=tn(qt),De=rn(Vr);function Fe([e,t=Lt]){let r=A(e)(f(W)(Nt),T(Ct)),n=$(t).filter(kt).filter(_t).filter(r);return n.filter(o=>n.filter(a=>a!==o).every(a=>!o.contains(a)))}function q([e]){return A(e)(f({pattern:_,selector:x})(o=>{var i=o,{pattern:t,selector:r}=i,n=D(i,["pattern","selector"]);return ye(Fe([t,r]),n)}),f({pattern:_})(n=>{var o=n,{pattern:t}=o,r=D(o,["pattern"]);return ye(Fe([t]),r)}),f({selector:x})(n=>{var o=n,{selector:t}=o,r=D(o,["selector"]);return ye($(t),r)}),T(()=>ye($(Lt),e)))}var nn=e=>P(P({},e),["near","above","below","leftOf","rightOf","containedBy"].reduce((t,r)=>F(P({},t),{[r]:A(e[r])(f(Jr)(z),f(M)(n=>z(...n)),T(null))}),{}));function ye(e,t={}){let b=nn(t),{near:r,containedBy:n,pickParent:o}=b,i=D(b,["near","containedBy","pickParent"]),a=Object.keys(i).length>0,c=Me(Mt),s=Me(At),u=({depth:v},w,[m])=>v===m.depth,d=M(n)?v=>{let w=v.map(s),m=p=>E=>E.map((h,l)=>({contained:h.contains(p),depth:l,el:p})).filter(({contained:h})=>h)[0];return p=>w.map(m(p))[0]}:()=>v=>({depth:0,el:v}),g=a?v=>{let{above:w,below:m,leftOf:p,rightOf:E}=Ke(v,h=>M(h)?h.map(c):h);return h=>{let l=R=>R.filter(Xt=>Xt.el!==h),S=c(h),k=!M(w)||l(w).every(R=>R.y>S.y),I=!M(m)||l(m).every(R=>R.y<S.y),L=!M(p)||l(p).every(R=>R.x>S.x),Oe=!M(E)||l(E).every(R=>R.x<S.x);return k&&I&&L&&Oe}}:()=>()=>!0,O=M(r)?v=>{let w=v.map(c);return m=>{let p=w.filter(h=>h.el!==m),E=c(m);return p.map(h=>({from:m,distance:Tt(h,E)}))[0]}}:()=>v=>({distance:0,from:v}),y=x(o)?v=>{let w=$(v);return m=>s(m).find(p=>w.includes(p))}:()=>Y;return e.map(d(n)).filter(Boolean).sort(Ae("depth")).filter(u).map(({el:v})=>v).filter(g(i)).map(O(r)).filter(Boolean).sort(Ae("distance")).map(({from:v})=>v).map(y(o)).filter(Boolean)}function $t(...e){return!!z(...e)[0]}function Bt(...e){return z(...e).map(ae)}function Ht(...e){return be(...e).map(je)}function We(...e){return z(...e).map(t=>t.innerText)}function zt(e,...t){let r=A(t)(f(Qr)(()=>[e]),f([M])(([n])=>n),f([_])(([n])=>({pattern:n})),f([Dt])(([n])=>[F(P({},n),{pattern:e})]),T(()=>t));return We(...r).map(n=>A(e)(f(W)(o=>{var a;let i=(a=n.match(o))!=null?a:[void 0];return i.length>1||i.groups!==void 0?i:i[0]}),f(x)(n),T(null))).filter(J(x,M))}function $e(e="baseWaitFor",t,...r){let n=A(r)(f([{timeoutInMs:ee(B)}])(Y),f([_,{timeoutInMs:ee(B)}])(Y),f([_,_,{timeoutInMs:ee(B)}])(Y),T(Ft*1e3)),o=new Z(e,r,{message:`timed out after ${n}ms trying to resolve query`});return new Promise((i,a)=>{let c=b=>(i(b),g()),s=()=>(a(o),g()),u=t({done:c,args:r}),d=setTimeout(s,n),g=()=>{clearTimeout(d),y(),O()},O=It(qt,u),y=qe(u);u()})}function Vt(...e){return $e("waitFor",t,...e);function t({args:r,done:n}){return()=>{let o=z(...r);o.length&&n(o.map(ae))}}}function Ut(...e){return $e("waitForCta",t,...e);function t({args:r,done:n}){return()=>{let o=De(...r);o.length&&n(o.map(ae))}}}function Qt(e,...t){if(!t.length)throw new Z("waitForValue",t,{message:"no query specified"});return $e("waitForValue",r,e,...t);function r({args:n,done:o}){return()=>{let i=be(...n.slice(1)).map(a=>({el:a,value:je(a)})).filter(({value:a})=>A([e,a])(f([W,x])(([c])=>c.test(a)),f([x,x])(([c])=>c.toLowerCase()===a.toLowerCase()))).map(({el:a})=>a);i.length&&o(i.map(ae))}}}var Pt=J(j(C,{withinMs:B}),j(C,{timeoutInMs:B}),j(C,{withinMs:B,timeoutInMs:B}));function Jt(...e){let t=A(e)(f([ee(Pt)])(Y),f([_,ee(Pt)])(Y),T({})),{withinMs:r=Ur}=t,{timeoutInMs:n=Ft*1e3}=t,o=Math.max(n,r+16),i=new Z("waitForIdle",e,{message:`timed out after ${o}ms waiting for DOM idle`}),a=A(e)(f([_])(!0),f([Gr])(!0),f([_,C])(!0),T(!1)),c=a&&Gt.selectorOf(...e);if(a&&!c)throw new Z("waitForIdle",e,{message:"need resolvable query to monitor for DOM idle, or omit query to monitor all DOM changes"});return new Promise((s,u)=>{let d=()=>(s(),v()),O=setTimeout(()=>(u(i),v()),o),[y,b]=ce(r,d),v=()=>{clearTimeout(O),b(),w()},w=qe(y,c);y()})}function K(e){return(...t)=>e(...t)[0]}var Gt={for:K(z),forCta:K(De),forInput:K(be),selectorOf:K(Bt),valueOf:K(Ht),waitFor:(...e)=>Vt(...e).then(t=>t[0]),waitForCta:(...e)=>Ut(...e).then(t=>t[0]),waitForValue:(...e)=>Qt(...e).then(t=>t[0]),waitForIdle:Jt,innerText:K(We),matchText:K(zt),hasContent:$t},on={for:z,forInput:be,forCta:De,selectorOf:Bt,valueOf:Ht,waitFor:Vt,waitForCta:Ut,waitForValue:Qt,waitForIdle:Jt,innerText:We,matchText:zt,hasContent:$t};return ir(an);})();
