/*
 * viddy
 * v1.5.0
 * https://github.com/shuckster/viddy
 * License: MIT
 */
var Gt=Object.create;var Oe=Object.defineProperty,Xt=Object.defineProperties,Yt=Object.getOwnPropertyDescriptor,Kt=Object.getOwnPropertyDescriptors,Zt=Object.getOwnPropertyNames,ae=Object.getOwnPropertySymbols,er=Object.getPrototypeOf,we=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var Be=(e,t,r)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P=(e,t)=>{for(var r in t||(t={}))we.call(t,r)&&Be(e,r,t[r]);if(ae)for(var r of ae(t))He.call(t,r)&&Be(e,r,t[r]);return e},F=(e,t)=>Xt(e,Kt(t));var D=(e,t)=>{var r={};for(var n in e)we.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&ae)for(var n of ae(e))t.indexOf(n)<0&&He.call(e,n)&&(r[n]=e[n]);return r};var V=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var tr=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Zt(t))!we.call(e,o)&&o!==r&&Oe(e,o,{get:()=>t[o],enumerable:!(n=Yt(t,o))||n.enumerable});return e};var rr=(e,t,r)=>(r=e!=null?Gt(er(e)):{},tr(t||!e||!e.__esModule?Oe(r,"default",{value:e,enumerable:!0}):r,e));var Te=V((le,tt)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});var ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et=function(){function e(t,r){var n=[],o=!0,i=!1,a=void 0;try{for(var c=t[Symbol.iterator](),s;!(o=(s=c.next()).done)&&(n.push(s.value),!(r&&n.length===r));o=!0);}catch(u){i=!0,a=u}finally{try{!o&&c.return&&c.return()}finally{if(i)throw a}}return n}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();le.default=gr;function gr(e,t){if(global.document)return!1;global.document=t.context||function(){for(var n=e;n.parent;)n=n.parent;return n}();var r=Object.getPrototypeOf(global.document);return Object.getOwnPropertyDescriptor(r,"childTags")||Object.defineProperty(r,"childTags",{enumerable:!0,get:function(){return this.children.filter(function(o){return o.type==="tag"||o.type==="script"||o.type==="style"})}}),Object.getOwnPropertyDescriptor(r,"attributes")||Object.defineProperty(r,"attributes",{enumerable:!0,get:function(){var o=this.attribs,i=Object.keys(o),a=i.reduce(function(c,s,u){return c[u]={name:s,value:o[s]},c},{});return Object.defineProperty(a,"length",{enumerable:!1,configurable:!1,value:i.length}),a}}),r.getAttribute||(r.getAttribute=function(n){return this.attribs[n]||null}),r.getElementsByTagName||(r.getElementsByTagName=function(n){var o=[];return B(this.childTags,function(i){(i.name===n||n==="*")&&o.push(i)}),o}),r.getElementsByClassName||(r.getElementsByClassName=function(n){var o=n.trim().replace(/\s+/g," ").split(" "),i=[];return B([this],function(a){var c=a.attribs.class;c&&o.every(function(s){return c.indexOf(s)>-1})&&i.push(a)}),i}),r.querySelectorAll||(r.querySelectorAll=function(n){var o=this;n=n.replace(/(>)(\S)/g,"$1 $2").trim();var i=yr(n),a=i.shift(),c=i.length;return a(this).filter(function(s){for(var u=0;u<c;){if(s=i[u](s,o),!s)return!1;u+=1}return!0})}),r.contains||(r.contains=function(n){var o=!1;return B([this],function(i,a){i===n&&(o=!0,a())}),o}),!0}function yr(e){return e.split(" ").reverse().map(function(t,r){var n=r===0,o=t.split(":"),i=et(o,2),a=i[0],c=i[1],s=null,u=null;if(function(){switch(!0){case/>/.test(a):u=function(l){return function(S){return S(l.parent)&&l.parent}};break;case/^\./.test(a):var b=a.substr(1).split(".");s=function(l){var S=l.attribs.class;return S&&b.every(function(k){return S.indexOf(k)>-1})},u=function(l,S){return n?l.getElementsByClassName(b.join(" ")):typeof l=="function"?l(s):ne(l,S,s)};break;case/^\[/.test(a):var v=a.replace(/\[|\]|"/g,"").split("="),w=et(v,2),m=w[0],p=w[1];s=function(l){var S=Object.keys(l.attribs).indexOf(m)>-1;return!!(S&&(!p||l.attribs[m]===p))},u=function(l,S){if(n){var k=function(){var I=[];return B([l],function(L){s(L)&&I.push(L)}),{v:I}}();if((typeof k=="undefined"?"undefined":ce(k))==="object")return k.v}return typeof l=="function"?l(s):ne(l,S,s)};break;case/^#/.test(a):var E=a.substr(1);s=function(l){return l.attribs.id===E},u=function(l,S){if(n){var k=function(){var I=[];return B([l],function(L,be){s(L)&&(I.push(L),be())}),{v:I}}();if((typeof k=="undefined"?"undefined":ce(k))==="object")return k.v}return typeof l=="function"?l(s):ne(l,S,s)};break;case/\*/.test(a):s=function(l){return!0},u=function(l,S){if(n){var k=function(){var I=[];return B([l],function(L){return I.push(L)}),{v:I}}();if((typeof k=="undefined"?"undefined":ce(k))==="object")return k.v}return typeof l=="function"?l(s):ne(l,S,s)};break;default:s=function(l){return l.name===a},u=function(l,S){if(n){var k=function(){var I=[];return B([l],function(L){s(L)&&I.push(L)}),{v:I}}();if((typeof k=="undefined"?"undefined":ce(k))==="object")return k.v}return typeof l=="function"?l(s):ne(l,S,s)}}}(),!c)return u;var d=c.match(/-(child|type)\((\d+)\)$/),g=d[1],O=parseInt(d[2],10)-1,y=function(v){if(v){var w=v.parent.childTags;g==="type"&&(w=w.filter(s));var m=w.findIndex(function(p){return p===v});if(m===O)return!0}return!1};return function(v){var w=u(v);return n?w.reduce(function(m,p){return y(p)&&m.push(p),m},[]):y(w)&&w}})}function B(e,t){e.forEach(function(r){var n=!0;t(r,function(){return n=!1}),r.childTags&&n&&B(r.childTags,t)})}function ne(e,t,r){for(;e.parent;){if(e=e.parent,r(e))return e;if(e===t)break}return null}tt.exports=le.default});var pe=V(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.convertNodeList=br;fe.escapeValue=Or;function br(e){for(var t=e.length,r=new Array(t),n=0;n<t;n++)r[n]=e[n];return r}function Or(e){return e&&e.replace(/['"`\\/:\?&!#$%^()[\]{|}*+;,.<=>@~]/g,"\\$&").replace(/\n/g,"A")}});var ft=V((de,lt)=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.default=wr;var it=pe(),rt={attribute:function(t){return["style","data-reactid","data-react-checksum"].indexOf(t)>-1}};function wr(e,t){var r=t.root,n=r===void 0?document:r,o=t.skip,i=o===void 0?null:o,a=t.priority,c=a===void 0?["id","class","href","src"]:a,s=t.ignore,u=s===void 0?{}:s,d=[],g=e,O=d.length,y=!1,b=i&&(Array.isArray(i)?i:[i]).map(function(m){return typeof m!="function"?function(p){return p===m}:m}),v=function(p){return i&&b.some(function(E){return E(p)})};for(Object.keys(u).forEach(function(m){m==="class"&&(y=!0);var p=u[m];typeof p!="function"&&(typeof p=="number"&&(p=p.toString()),typeof p=="string"&&(p=new RegExp((0,it.escapeValue)(p).replace(/\\/g,"\\\\"))),typeof p=="boolean"&&(p=p?/(?:)/:/.^/),u[m]=function(E,h){return p.test(h)})}),y&&function(){var m=u.attribute;u.attribute=function(p,E,h){return u.class(E)||m&&m(p,E,h)}}();g!==n;){if(v(g)!==!0){if(nt(c,g,u,d,n)||ot(g,u,d,n))break;nt(c,g,u,d),d.length===O&&ot(g,u,d),d.length===O&&Sr(c,g,u,d)}g=g.parentNode,O=d.length}if(g===n){var w=ut(c,g,u);d.unshift(w)}return d.join(" ")}function nt(e,t,r,n){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:t.parentNode,i=at(e,t,r);if(i){var a=o.querySelectorAll(i);if(a.length===1)return n.unshift(i),!0}return!1}function at(e,t,r){for(var n=t.attributes,o=Object.keys(n).sort(function(v,w){var m=e.indexOf(n[v].name),p=e.indexOf(n[w].name);return p===-1?m===-1?0:-1:m-p}),i=0,a=o.length;i<a;i++){var c=o[i],s=n[c],u=s.name,d=(0,it.escapeValue)(s.value),g=r[u]||r.attribute,O=rt[u]||rt.attribute;if(!ct(g,u,d,O)){var y="["+u+'="'+d+'"]';if(/\b\d/.test(d)===!1&&(u==="id"&&(y="#"+d),u==="class")){var b=d.trim().replace(/\s+/g,".");y="."+b}return y}}return null}function ot(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e.parentNode,o=st(e,t);if(o){var i=n.getElementsByTagName(o);if(i.length===1)return r.unshift(o),!0}return!1}function st(e,t){var r=e.tagName.toLowerCase();return ct(t.tag,null,r)?null:r}function Sr(e,t,r,n){for(var o=t.parentNode,i=o.childTags||o.children,a=0,c=i.length;a<c;a++){var s=i[a];if(s===t){var u=ut(e,s,r);if(!u)return console.warn(`
          Element couldn't be matched through strict ignore pattern!
        `,s,r,u);var d="> "+u+":nth-child("+(a+1)+")";return n.unshift(d),!0}}return!1}function ut(e,t,r){var n=at(e,t,r);return n||(n=st(t,r)),n}function ct(e,t,r,n){if(!r)return!0;var o=e||n;return o?o(t,r,n):!1}lt.exports=de.default});var Ce=V((me,pt)=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.default=Ar;var xr=Te(),Er=_r(xr),kr=pe();function _r(e){return e&&e.__esModule?e:{default:e}}function Ar(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Array.isArray(t)||(t=t.length?(0,kr.convertNodeList)(t):[t]),!t.length||t.some(function(g){return g.nodeType!==1}))throw new Error('Invalid input - to compare HTMLElements its necessary to provide a reference of the selected node(s)! (missing "elements")');var n=(0,Er.default)(t[0],r),o=e.replace(/> /g,">").split(/\s+(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(o.length<2)return ve("",e,"",t);for(var i=[o.pop()];o.length>1;){var a=o.pop(),c=o.join(" "),s=i.join(" "),u=c+" "+s,d=document.querySelectorAll(u);d.length!==t.length&&i.unshift(ve(c,a,s,t))}return i.unshift(o[0]),o=i,o[0]=ve("",o[0],o.slice(1).join(" "),t),o[o.length-1]=ve(o.slice(0,-1).join(" "),o[o.length-1],"",t),n&&delete global.document,o.join(" ").replace(/>/g,"> ").trim()}function ve(e,t,r,n){if(e.length&&(e=e+" "),r.length&&(r=" "+r),/\[*\]/.test(t)){var o=t.replace(/=.*$/,"]"),i=""+e+o+r,a=document.querySelectorAll(i);if(te(a,n))t=o;else for(var c=document.querySelectorAll(""+e+o),s=function(){var h=c[u];if(n.some(function(S){return h.contains(S)})){var l=h.tagName.toLowerCase();return i=""+e+l+r,a=document.querySelectorAll(i),te(a,n)&&(t=l),"break"}},u=0,d=c.length;u<d;u++){var i,a,g=s();if(g==="break")break}}if(/>/.test(t)){var O=t.replace(/>/,""),i=""+e+O+r,a=document.querySelectorAll(i);te(a,n)&&(t=O)}if(/:nth-child/.test(t)){var y=t.replace(/nth-child/g,"nth-of-type"),i=""+e+y+r,a=document.querySelectorAll(i);te(a,n)&&(t=y)}if(/\.\S+\.\S+/.test(t)){for(var b=t.trim().split(".").slice(1).map(function(E){return"."+E}).sort(function(E,h){return E.length-h.length});b.length;){var v=t.replace(b.shift(),"").trim(),i=(""+e+v+r).trim();if(!i.length||i.charAt(0)===">"||i.charAt(i.length-1)===">")break;var a=document.querySelectorAll(i);te(a,n)&&(t=v)}if(b=t&&t.match(/\./g),b&&b.length>2)for(var w=document.querySelectorAll(""+e+t),m=function(){var h=w[u];if(n.some(function(S){return h.contains(S)})){var l=h.tagName.toLowerCase();return i=""+e+l+r,a=document.querySelectorAll(i),te(a,n)&&(t=l),"break"}},u=0,d=w.length;u<d;u++){var i,a,p=m();if(p==="break")break}}return t}function te(e,t){var r=e.length;return r===t.length&&t.every(function(n){for(var o=0;o<r;o++)if(e[o]===n)return!0;return!1})}pt.exports=me.default});var Ne=V(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.getCommonAncestor=Mr;he.getCommonProperties=Tr;function Mr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.root,n=r===void 0?document:r,o=[];e.forEach(function(g,O){for(var y=[];g!==n;)g=g.parentNode,y.unshift(g);o[O]=y}),o.sort(function(g,O){return g.length-O.length});for(var i=o.shift(),a=null,c=function(){var O=i[s],y=o.some(function(b){return!b.some(function(v){return v===O})});if(y)return"break";a=O},s=0,u=i.length;s<u;s++){var d=c();if(d==="break")break}return a}function Tr(e){var t={classes:[],attributes:{},tag:null};return e.forEach(function(r){var n=t.classes,o=t.attributes,i=t.tag;if(n!==void 0){var a=r.getAttribute("class");a?(a=a.trim().split(" "),n.length?(n=n.filter(function(s){return a.some(function(u){return u===s})}),n.length?t.classes=n:delete t.classes):t.classes=a):delete t.classes}if(o!==void 0&&function(){var s=r.attributes,u=Object.keys(s).reduce(function(O,y){var b=s[y],v=b.name;return b&&v!=="class"&&(O[v]=b.value),O},{}),d=Object.keys(u),g=Object.keys(o);d.length?g.length?(o=g.reduce(function(O,y){var b=o[y];return b===u[y]&&(O[y]=b),O},{}),Object.keys(o).length?t.attributes=o:delete t.attributes):t.attributes=u:delete t.attributes}(),i!==void 0){var c=r.tagName.toLowerCase();i?c!==i&&delete t.tag:t.tag=c}}),t}});var yt=V(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});var Cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};oe.getSingleSelector=Pe;oe.getMultiSelector=gt;oe.default=qr;var Nr=Te(),vt=Ie(Nr),Ir=ft(),Pr=Ie(Ir),Lr=Ce(),mt=Ie(Lr),dt=pe(),ht=Ne();function Ie(e){return e&&e.__esModule?e:{default:e}}function Pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.nodeType===3&&(e=e.parentNode),e.nodeType!==1)throw new Error('Invalid input - only HTMLElements or representations of them are supported! (not "'+(typeof e=="undefined"?"undefined":Cr(e))+'")');var r=(0,vt.default)(e,t),n=(0,Pr.default)(e,t),o=(0,mt.default)(n,e,t);return r&&delete global.document,o}function gt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Array.isArray(e)||(e=(0,dt.convertNodeList)(e)),e.some(function(u){return u.nodeType!==1}))throw new Error("Invalid input - only an Array of HTMLElements or representations of them is supported!");var r=(0,vt.default)(e[0],t),n=(0,ht.getCommonAncestor)(e,t),o=Pe(n,t),i=jr(e),a=i[0],c=(0,mt.default)(o+" "+a,e,t),s=(0,dt.convertNodeList)(document.querySelectorAll(c));return e.every(function(u){return s.some(function(d){return d===u})})?(r&&delete global.document,c):console.warn(`
      The selected elements can't be efficiently mapped.
      Its probably best to use multiple single selectors instead!
    `,e)}function jr(e){var t=(0,ht.getCommonProperties)(e),r=t.classes,n=t.attributes,o=t.tag,i=[];if(o&&i.push(o),r){var a=r.map(function(s){return"."+s}).join("");i.push(a)}if(n){var c=Object.keys(n).reduce(function(s,u){return s.push("["+u+'="'+n[u]+'"]'),s},[]).join("");i.push(c)}return i.length,[i.join("")]}function qr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e.length&&!e.name?gt(e,t):Pe(e,t)}});var wt=V(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.default=N.common=N.optimize=N.getMultiSelector=N.getSingleSelector=N.select=void 0;var Le=yt();Object.defineProperty(N,"getSingleSelector",{enumerable:!0,get:function(){return Le.getSingleSelector}});Object.defineProperty(N,"getMultiSelector",{enumerable:!0,get:function(){return Le.getMultiSelector}});var bt=Ot(Le),Fr=Ce(),Rr=Ot(Fr),Dr=Ne(),Wr=$r(Dr);function $r(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Ot(e){return e&&e.__esModule?e:{default:e}}N.select=bt.default;N.optimize=Rr.default;N.common=Wr;N.default=bt.default});var nr=Object.defineProperty;var or=(e,t)=>{for(var r in t)nr(e,r,{get:t[r],enumerable:!0})},xe={};or(xe,{instanceOf:()=>Ee,isArguments:()=>Ve,isArray:()=>ar,isDate:()=>sr,isFunction:()=>ur,isNumber:()=>lr,isObject:()=>Ue,isPojo:()=>pr,isRegExp:()=>fr,isString:()=>cr});var ze=Object.prototype,ir=ze.toString,se=e=>t=>typeof t===e,Ee=e=>t=>t instanceof e,{isArray:ar}=Array,Ve=e=>ir.call(e)==="[object Arguments]",sr=e=>Ee(Date)(e)&&!isNaN(e),ur=se("function"),cr=se("string"),lr=e=>e===e&&se("number")(e),Ue=e=>e!==null&&se("object")(e),fr=Ee(RegExp),pr=e=>e===null||!Ue(e)||Ve(e)?!1:Object.getPrototypeOf(e)===ze,{isArray:M,isDate:tn,isFunction:Q,isNumber:$}=xe,{isPojo:C,isRegExp:W,isString:x,instanceOf:rn}=xe,{keys:Qe,entries:nn,assign:on}=Object;function A(e){return(...t)=>ke(...t)(e)}var ke=(...e)=>{let t;return r=>e.find(n=>{let o=n(r),{matched:i,value:a}=o||{};return[i,a].every(Q)?i(r)&&(t=a(r),!0):o&&(t=o)})&&t},T=e=>t=>({matched:()=>!0,value:()=>Q(e)?e(t):e}),Se=e=>t=>r=>({matched:()=>U(e,r,n=>r=n),value:()=>Q(t)?x(r)&&W(e)?t(...dr(r.match(e))):t(r):t}),f=(...e)=>{if(e.length===1){let[t]=e;return Se(t)}if(e.length===2){let[t,r]=e;return Se(t)(r)}if(e.length>2){let t=e.slice(-1)[0],r=e.slice(0,-1);return Se(j(r))(t)}throw new Error("expected 1 or 2 arguments")},dr=e=>{let{groups:t}=e;return t?[t,e]:[e]},U=(e,t,r)=>C(e)?Qe(e).every(n=>U(e[n],t==null?void 0:t[n],r)):M(e)?M(t)&&e.length===t.length&&e.every((n,o)=>U(n,t==null?void 0:t[o],r)):Q(e)?e(t,r):x(t)&&W(e)?e.test(t):e===t||[e,t].every(Number.isNaN),Z=(...e)=>(t,r)=>e.length===0||(Q(e[0])?e[0](t):U(e[0],t,r))?(r(t),!0):!1;var ee=e=>(t,r)=>!U(e,t,r),J=(...e)=>(t,r)=>e.flat().some(n=>U(n,t,r)),j=(...e)=>(t,r)=>e.flat().every(n=>U(n,t,r));var _e=e=>e!==e||!e&&e!==0&&e!==!1||M(e)&&!e.length||C(e)&&!Qe(e).length,Je=e=>!_e(e);var Ge=e=>vr(t=>t.includes(e));var vr=e=>(t,r)=>(M(t)||x(t))&&e(t,r);var Ae=e=>x(e)?(t,r)=>t[e]-r[e]:(t,r)=>t-r;function ue(e,t){let[r,n]=mr(e,t);return[(...i)=>(n(),r(...i)),n]}function mr(e,t){let r;return[(...i)=>{r=setTimeout(t,e,...i)},()=>clearTimeout(r)]}var Xe=(...e)=>t=>e.reduceRight((r,n)=>n(r),t);function Me(e,t=new Map){return r=>t.has(r)?t.get(r):t.set(r,e(r)).get(r)}var Ye=(e,t)=>Object.entries(e).reduce((r,[n,o])=>(r[n]=t(o,n),r),{}),Y=e=>e,G=()=>({valueOf:()=>{},toString:()=>"Nothing",map:()=>G(),chain:()=>G(),fork:e=>e(),orElse:e=>e(),ap:()=>G()});G.of=()=>G();var X=e=>({valueOf:()=>e,toString:()=>`Just(${e})`,map:t=>X(t(e)),chain:t=>t(e),fork:(t,r)=>r(e),orElse:()=>X(e),ap:t=>t.map(e)});X.of=e=>X(e);var hr=(e=t=>t!=null)=>{let t=r=>e(r)?X(r):G();return t.of=r=>t(r),t},Ke=e=>{try{return X(e())}catch(t){return G()}},ln=hr(),Ze=e=>()=>X(e);var xt=rr(wt(),1),Et=e=>e instanceof HTMLElement,kt=e=>e.offsetParent!==null,H=e=>Ke(()=>document.querySelectorAll(e)).map(Array.from).orElse(Ze([])).valueOf();function _t(e){let t=[],r=e.parentNode;for(;r&&r!==document;)t.push(r),r=r.parentNode;return t}function At(e){let{top:t,left:r,width:n,height:o}=e.getBoundingClientRect(),i=n/2,a=o/2,c=r+i,s=t+a;return{el:e,x:c,y:s,halfWidth:i,halfHeight:a}}function Mt(e,t){let r=t.x-e.x,n=t.y-e.y,o=St(r,n,e.x,e.y,e.halfWidth,e.halfHeight),i=St(-r,-n,t.x,t.y,t.halfWidth,t.halfHeight);return Math.hypot(o.x-i.x,o.y-i.y)}function St(e,t,r,n,o,i){return Math.abs(t/e)<i/o?{x:r+(e>0?o:-o),y:n+t*o/Math.abs(e)}:{x:r+e*i/Math.abs(t),y:n+(t>0?i:-i)}}function Tt(e){let t=e.toLowerCase();return r=>r.textContent.toLowerCase().includes(t)&&r.innerText.toLowerCase().includes(t)}var Ct=e=>t=>e.test(t.textContent)&&e.test(t.innerText);function ie(e){if(e instanceof Element)return typeof global=="undefined"&&typeof window!="undefined"&&(global=window),(0,xt.select)(e)}function je(e){return A(e)(f({val:Q})(t=>t.val()),f({tagName:"SELECT",multiple:!0})(({options:t})=>Array.from(t).reduce((r,n)=>n.selected?r.concat(n.value):r,[])),f({type:"checkbox",value:Je})(t=>t.checked?t.value:""),f({type:"checkbox"})(t=>t.checked?"checked":""),f({contenteditable:!0})(t=>t.innerHTML),T(t=>t.value))}function qe(e,t){let r=t?new MutationObserver(o):new MutationObserver(n);return r.observe(document.body,{childList:!0,attributes:!0,subtree:!0}),()=>r.disconnect();function n(i){setTimeout(()=>e(i),1)}function o(i){let a=H(t);for(let c of i){let s=c.target;if(a.some(u=>s.contains(u))){setTimeout(()=>e(),1);break}}}}var Nt=(e,t)=>{let[r]=ue(32,t),n=H(e).map(o=>(o.addEventListener("change",r,{passive:!0}),()=>o.removeEventListener("change",r))).concat(()=>document.body.removeEventListener("click",r)).concat(()=>document.body.removeEventListener("keyup",r));return document.body.addEventListener("click",r,{passive:!0}),document.body.addEventListener("keyup",r,{passive:!0}),()=>n.forEach(o=>o())};var Pt="body *",Lt=["button","submit","reset","file"],jt=Lt.map(e=>`input:not([type=${e}])`).concat("select","textarea").join(", "),Br=Lt.map(e=>`input[type=${e}]`).concat("a","button").join(", "),qt=5,Hr=500,zr=j(M,_e),_=J(x,W),Vr=J(_,C),Ur=J(j(C,{pattern:_}),j(C,{selector:x})),Ft=j(C,{pattern:_,selector:ee(x)}),Rt=j(C,{pattern:ee(_),selector:ee(x)}),Dt=j(C,{selector:ee(x),pickParent:ee(x)}),Re="|<-REGEXP::FLAGS->|",Qr=j(x,Ge(Re)),Jr=e=>[e.source,e.flags].join(Re),Gr=e=>new RegExp(...e.split(Re)),An=(...e)=>JSON.stringify(e,(t,r)=>A(r)(f(W)(Jr),T(r))),Mn=e=>JSON.parse(e,(t,r)=>A(r)(f(Qr)(Gr),T(r))),re=class extends Error{constructor(t,r,{message:n="could not resolve query to any elements"}){let o=c=>`/${c.source}/${c.flags}`,i=(c,s)=>W(s)?o(s):s,a=JSON.stringify(r,i,2);super(`${n}

viddy.${t}(...${a})
`),this.name="ViddyError"}};var z=(...e)=>A(e)(f([_])(Fe),f([_,C])(([t,r])=>q([P({pattern:t},r)])),f([C])(q),T([]));function Xr(e){return(...t)=>A(t)(f([_])(([r])=>q([{selector:e,near:r}])),f([_,Dt])(([r,n])=>q([{selector:e,near:F(P({},n),{pattern:r})}])),f([Ft])(o=>{var[i]=o,a=i,{pattern:r}=a,n=D(a,["pattern"]);return q([{selector:e,near:F(P({},n),{pattern:r})}])}),f([{selector:x}])(o=>{var[i]=o,a=i,{selector:r}=a,n=D(a,["selector"]);return q([F(P({},n),{selector:r})])}),T([]))}function Yr(e){return(...t)=>Xe(r=>r.filter(ke(f(J(H(e)))(!0))))(A(t)(f([_])(([r])=>q([{containedBy:{selector:e},pattern:r}])),f([_,Dt])(([r,n])=>q([F(P({},n),{containedBy:{selector:e},pattern:r})])),f([Ft])(o=>{var[i]=o,a=i,{pattern:r}=a,n=D(a,["pattern"]);return q([F(P({},n),{containedBy:{selector:e},pattern:r})])}),f([Rt])(([r])=>q([F(P({},r),{containedBy:{selector:e}})])),f([{selector:x}])(o=>{var[i]=o,a=i,{selector:r}=a,n=D(a,["selector"]);return q([F(P({},n),{selector:r})])}),T(q([{selector:e}]))))}var ye=Xr(jt),De=Yr(Br);function Fe([e,t=Pt]){let r=A(e)(f(W)(Ct),T(Tt)),n=H(t).filter(Et).filter(kt).filter(r);return n.filter(o=>n.filter(a=>a!==o).every(a=>!o.contains(a)))}function q([e]){return A(e)(f({pattern:_,selector:x})(o=>{var i=o,{pattern:t,selector:r}=i,n=D(i,["pattern","selector"]);return ge(Fe([t,r]),n)}),f({pattern:_})(n=>{var o=n,{pattern:t}=o,r=D(o,["pattern"]);return ge(Fe([t]),r)}),f({selector:x})(n=>{var o=n,{selector:t}=o,r=D(o,["selector"]);return ge(H(t),r)}),T(()=>ge(H(Pt),e)))}var Kr=e=>P(P({},e),["near","above","below","leftOf","rightOf","containedBy"].reduce((t,r)=>F(P({},t),{[r]:A(e[r])(f(Vr)(z),f(M)(n=>z(...n)),T(null))}),{}));function ge(e,t={}){let b=Kr(t),{near:r,containedBy:n,pickParent:o}=b,i=D(b,["near","containedBy","pickParent"]),a=Object.keys(i).length>0,c=Me(At),s=Me(_t),u=({depth:v},w,[m])=>v===m.depth,d=M(n)?v=>{let w=v.map(s),m=p=>E=>E.map((h,l)=>({contained:h.contains(p),depth:l,el:p})).filter(({contained:h})=>h)[0];return p=>w.map(m(p))[0]}:()=>v=>({depth:0,el:v}),g=a?v=>{let{above:w,below:m,leftOf:p,rightOf:E}=Ye(v,h=>M(h)?h.map(c):h);return h=>{let l=R=>R.filter(Jt=>Jt.el!==h),S=c(h),k=!M(w)||l(w).every(R=>R.y>S.y),I=!M(m)||l(m).every(R=>R.y<S.y),L=!M(p)||l(p).every(R=>R.x>S.x),be=!M(E)||l(E).every(R=>R.x<S.x);return k&&I&&L&&be}}:()=>()=>!0,O=M(r)?v=>{let w=v.map(c);return m=>{let p=w.filter(h=>h.el!==m),E=c(m);return p.map(h=>({from:m,distance:Mt(h,E)}))[0]}}:()=>v=>({distance:0,from:v}),y=x(o)?v=>{let w=H(v);return m=>s(m).find(p=>w.includes(p))}:()=>Y;return e.map(d(n)).filter(Boolean).sort(Ae("depth")).filter(u).map(({el:v})=>v).filter(g(i)).map(O(r)).filter(Boolean).sort(Ae("distance")).map(({from:v})=>v).map(y(o)).filter(Boolean)}function Wt(...e){return!!z(...e)[0]}function $t(...e){return z(...e).map(ie)}function Bt(...e){return ye(...e).map(je)}function We(...e){return z(...e).map(t=>t.innerText)}function Ht(e,...t){let r=A(t)(f(zr)(()=>[e]),f([M])(([n])=>n),f([_])(([n])=>({pattern:n})),f([Rt])(([n])=>[F(P({},n),{pattern:e})]),T(()=>t));return We(...r).map(n=>A(e)(f(W)(o=>{var a;let i=(a=n.match(o))!=null?a:[void 0];return i.length>1||i.groups!==void 0?i:i[0]}),f(x)(n),T(null))).filter(J(x,M))}function $e(e="baseWaitFor",t,...r){let n=A(r)(f([{timeoutInMs:Z($)}])(Y),f([_,{timeoutInMs:Z($)}])(Y),f([_,_,{timeoutInMs:Z($)}])(Y),T(qt*1e3)),o=new re(e,r,{message:`timed out after ${n}ms trying to resolve query`});return new Promise((i,a)=>{let c=b=>(i(b),g()),s=()=>(a(o),g()),u=t({done:c,args:r}),d=setTimeout(s,n),g=()=>{clearTimeout(d),y(),O()},O=Nt(jt,u),y=qe(u);u()})}function zt(...e){return $e("waitFor",t,...e);function t({args:r,done:n}){return()=>{let o=z(...r);o.length&&n(o.map(ie))}}}function Vt(...e){return $e("waitForCta",t,...e);function t({args:r,done:n}){return()=>{let o=De(...r);o.length&&n(o.map(ie))}}}function Ut(e,...t){if(!t.length)throw new re("waitForValue",t,{message:"no query specified"});return $e("waitForValue",r,e,...t);function r({args:n,done:o}){return()=>{let i=ye(...n.slice(1)).map(a=>({el:a,value:je(a)})).filter(({value:a})=>A([e,a])(f([W,x])(([c])=>c.test(a)),f([x,x])(([c])=>c.toLowerCase()===a.toLowerCase()))).map(({el:a})=>a);i.length&&o(i.map(ie))}}}var It=J(j(C,{withinMs:$}),j(C,{timeoutInMs:$}),j(C,{withinMs:$,timeoutInMs:$}));function Qt(...e){let t=A(e)(f([Z(It)])(Y),f([_,Z(It)])(Y),T({})),{withinMs:r=Hr}=t,{timeoutInMs:n=qt*1e3}=t,o=Math.max(n,r+16),i=new re("waitForIdle",e,{message:`timed out after ${o}ms waiting for DOM idle`}),a=A(e)(f([_])(!0),f([Ur])(!0),f([_,C])(!0),T(!1)),c=a&&Zr.selectorOf(...e);if(a&&!c)throw new re("waitForIdle",e,{message:"need resolvable query to monitor for DOM idle, or omit query to monitor all DOM changes"});return new Promise((s,u)=>{let d=()=>(s(),v()),O=setTimeout(()=>(u(i),v()),o),[y,b]=ue(r,d),v=()=>{clearTimeout(O),b(),w()},w=qe(y,c);y()})}function K(e){return(...t)=>e(...t)[0]}var Zr={for:K(z),forCta:K(De),forInput:K(ye),selectorOf:K($t),valueOf:K(Bt),waitFor:(...e)=>zt(...e).then(t=>t[0]),waitForCta:(...e)=>Vt(...e).then(t=>t[0]),waitForValue:(...e)=>Ut(...e).then(t=>t[0]),waitForIdle:Qt,innerText:K(We),matchText:K(Ht),hasContent:Wt},Tn={for:z,forInput:ye,forCta:De,selectorOf:$t,valueOf:Bt,waitFor:zt,waitForCta:Vt,waitForValue:Ut,waitForIdle:Qt,innerText:We,matchText:Ht,hasContent:Wt};export{re as ViddyError,H as qsArray,An as serialize,Mn as unserialize,Zr as viddy,Tn as viddyWell};
